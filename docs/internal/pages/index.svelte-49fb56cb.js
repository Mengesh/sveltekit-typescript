import{W as ne,L as ae,M as se,X as le,S as D,i as W,s as x,e as T,t as R,k as M,c as q,a as A,h as C,d,m as B,b as O,N as G,g as w,J as y,O as Y,j as H,l as L,K as v,P as z,Q as J,R as re,q as F,o as I,w as Z,x as $,y as ee,B as te}from"../chunks/vendor-7a87cf4c.js";import{b as oe}from"../chunks/paths-4b3c6e7e.js";let U=null;const ce=async(s,e)=>{if(U)return U;e==null&&(e=s.split("/").pop());const a=new le,t=new ne;U=new ae(a,t),await U.instantiate(se);const n=await fetch(s).then(r=>r.arrayBuffer());return await U.registerFileBuffer(e,new Uint8Array(n)),U};function j(s,e,a){const t=s.slice();return t[6]=e[a][0],t[7]=e[a][1],t}function K(s){let e,a,t,n=s[6]+"",r,o,c=s[7]+"",_,i,b,f;function E(){return s[5](s[6])}return{c(){e=T("p"),a=T("button"),t=T("span"),r=R(n),o=M(),_=R(c),i=M(),this.h()},l(k){e=q(k,"P",{class:!0});var m=A(e);a=q(m,"BUTTON",{class:!0});var S=A(a);t=q(S,"SPAN",{class:!0});var p=A(t);r=C(p,n),p.forEach(d),S.forEach(d),o=B(m),_=C(m,c),i=B(m),m.forEach(d),this.h()},h(){O(t,"class","text-xs svelte-1qrxcsn"),O(a,"class","rounded svelte-1qrxcsn"),O(e,"class","rounded mt-3 text-sm svelte-1qrxcsn"),G(e,"bg-blue-100",s[0]==s[6])},m(k,m){w(k,e,m),y(e,a),y(a,t),y(t,r),y(e,o),y(e,_),y(e,i),b||(f=Y(a,"click",E),b=!0)},p(k,m){s=k,m&2&&n!==(n=s[6]+"")&&H(r,n),m&2&&c!==(c=s[7]+"")&&H(_,c),m&3&&G(e,"bg-blue-100",s[0]==s[6])},d(k){k&&d(e),b=!1,f()}}}function ie(s){let e,a=s[1],t=[];for(let n=0;n<a.length;n+=1)t[n]=K(j(s,a,n));return{c(){for(let n=0;n<t.length;n+=1)t[n].c();e=L()},l(n){for(let r=0;r<t.length;r+=1)t[r].l(n);e=L()},m(n,r){for(let o=0;o<t.length;o+=1)t[o].m(n,r);w(n,e,r)},p(n,[r]){if(r&7){a=n[1];let o;for(o=0;o<a.length;o+=1){const c=j(n,a,o);t[o]?t[o].p(c,r):(t[o]=K(c),t[o].c(),t[o].m(e.parentNode,e))}for(;o<t.length;o+=1)t[o].d(1);t.length=a.length}},i:v,o:v,d(n){z(t,n),n&&d(e)}}}function ue(s,e,a){let{paragraphs:t=[]}=e,{id:n=null}=e,{selected_word:r=""}=e,{haplaxes:o=[]}=e;function c(i){a(0,n=i)}const _=i=>c(i);return s.$$set=i=>{"paragraphs"in i&&a(1,t=i.paragraphs),"id"in i&&a(0,n=i.id),"selected_word"in i&&a(3,r=i.selected_word),"haplaxes"in i&&a(4,o=i.haplaxes)},[n,t,c,r,o,_]}class fe extends D{constructor(e){super();W(this,e,ue,ie,x,{paragraphs:1,id:0,selected_word:3,haplaxes:4})}}function de(s){let e;return{c(){e=T("div"),this.h()},l(a){e=q(a,"DIV",{id:!0,class:!0}),A(e).forEach(d),this.h()},h(){O(e,"id","loading"),O(e,"class","svelte-qfy6rn")},m(a,t){w(a,e,t)},p:v,i:v,o:v,d(a){a&&d(e)}}}class he extends D{constructor(e){super();W(this,e,null,de,x,{})}}function Q(s,e,a){const t=s.slice();return t[11]=e[a],t}function X(s){let e,a=s[11]+"",t,n,r;function o(){return s[4](s[11])}return{c(){e=T("div"),t=R(a),this.h()},l(c){e=q(c,"DIV",{class:!0});var _=A(e);t=C(_,a),_.forEach(d),this.h()},h(){O(e,"class","year svelte-c41948")},m(c,_){w(c,e,_),y(e,t),n||(r=Y(e,"click",o),n=!0)},p(c,_){s=c},d(c){c&&d(e),n=!1,r()}}}function _e(s){return{c:v,l:v,m:v,p:v,i:v,o:v,d:v}}function pe(s){let e,a;return e=new fe({props:{results:s[2]}}),{c(){Z(e.$$.fragment)},l(t){$(e.$$.fragment,t)},m(t,n){ee(e,t,n),a=!0},p(t,n){const r={};n&4&&(r.results=t[2]),e.$set(r)},i(t){a||(F(e.$$.fragment,t),a=!0)},o(t){I(e.$$.fragment,t),a=!1},d(t){te(e,t)}}}function me(s){let e,a,t;return a=new he({}),{c(){e=R(`Preparing database...
  `),Z(a.$$.fragment)},l(n){e=C(n,`Preparing database...
  `),$(a.$$.fragment,n)},m(n,r){w(n,e,r),ee(a,n,r),t=!0},p:v,i(n){t||(F(a.$$.fragment,n),t=!0)},o(n){I(a.$$.fragment,n),t=!1},d(n){n&&d(e),te(a,n)}}}function ge(s){let e,a,t,n,r,o,c,_,i,b,f,E,k,m,S=s[3],p=[];for(let l=0;l<S.length;l+=1)p[l]=X(Q(s,S,l));let g={ctx:s,current:null,token:null,hasCatch:!1,pending:me,then:pe,catch:_e,value:10,blocks:[,,,]};return J(k=s[1],g),{c(){e=T("h1"),a=R("Duck DB Svelte-kit demo"),t=M(),n=T("div"),r=R(`This is a demo of a static, database-driven page using duckdb WASM.
  All the primary text is stored in a parquet file structured to the `),o=T("a"),c=R("nonconsumptive"),_=R(` text sharing spec. On load, it gets a copy of duckdb WASM and uses it to mount 
  the parquet file into the database. Clicking on any year will load the state of the Union address for that year.`),i=M(),b=T("div");for(let l=0;l<p.length;l+=1)p[l].c();f=M(),E=L(),g.block.c(),this.h()},l(l){e=q(l,"H1",{});var h=A(e);a=C(h,"Duck DB Svelte-kit demo"),h.forEach(d),t=B(l),n=q(l,"DIV",{class:!0});var u=A(n);r=C(u,`This is a demo of a static, database-driven page using duckdb WASM.
  All the primary text is stored in a parquet file structured to the `),o=q(u,"A",{href:!0});var N=A(o);c=C(N,"nonconsumptive"),N.forEach(d),_=C(u,` text sharing spec. On load, it gets a copy of duckdb WASM and uses it to mount 
  the parquet file into the database. Clicking on any year will load the state of the Union address for that year.`),u.forEach(d),i=B(l),b=q(l,"DIV",{class:!0});var V=A(b);for(let P=0;P<p.length;P+=1)p[P].l(V);V.forEach(d),f=B(l),E=L(),g.block.l(l),this.h()},h(){O(o,"href","https://nonconsumptive.org"),O(n,"class","description"),O(b,"class","years svelte-c41948")},m(l,h){w(l,e,h),y(e,a),w(l,t,h),w(l,n,h),y(n,r),y(n,o),y(o,c),y(n,_),w(l,i,h),w(l,b,h);for(let u=0;u<p.length;u+=1)p[u].m(b,null);w(l,f,h),w(l,E,h),g.block.m(l,g.anchor=h),g.mount=()=>E.parentNode,g.anchor=E,m=!0},p(l,[h]){if(s=l,h&9){S=s[3];let u;for(u=0;u<S.length;u+=1){const N=Q(s,S,u);p[u]?p[u].p(N,h):(p[u]=X(N),p[u].c(),p[u].m(b,null))}for(;u<p.length;u+=1)p[u].d(1);p.length=S.length}g.ctx=s,h&2&&k!==(k=s[1])&&J(k,g)||re(g,s,h)},i(l){m||(F(g.block),m=!0)},o(l){for(let h=0;h<3;h+=1){const u=g.blocks[h];I(u)}m=!1},d(l){l&&d(e),l&&d(t),l&&d(n),l&&d(i),l&&d(b),z(p,l),l&&d(f),l&&d(E),g.block.d(l),g.token=null,g=null}}}function be(s,e,a){let t,n,r;async function o(){console.log("REPREPPING");const f=await t;await f.query("CREATE TABLE p1 AS SELECT * FROM parquet_scan('SOTU.parquet')"),await f.query(`CREATE VIEW wordcounts_raw AS SELECT * FROM (SELECT "@id" id, 
        UNNEST("nc:unigrams").word0 as word, 
        UNNEST("nc:unigrams").count as count FROM
         p1) t1
    `),await f.query(`CREATE TABLE wordcounts AS SELECT * FROM 
      wordcounts_raw
      NATURAL JOIN (SELECT word, SUM(count) as tot, COUNT(*) AS df FROM wordcounts_raw GROUP BY word) t2
    `)}async function c(){const f=await ce(`${oe}/SOTU.parquet`,"SOTU.parquet");return a(1,t=f.connect()),o(),t}c();const _=[];for(let f=1934;f<2021;f++)_.push(f);async function i(f){const E=await t;a(2,n=E.query(`
      SELECT * FROM parquet_scan('SOTU.parquet') WHERE year == ${f}
    `))}const b=f=>a(0,r=f);return s.$$.update=()=>{s.$$.dirty&3&&t.then(f=>i(r))},a(1,t=new Promise(()=>{})),a(2,n=null),a(0,r=1936),[r,t,n,_,b]}class we extends D{constructor(e){super();W(this,e,be,ge,x,{})}}export{we as default};
