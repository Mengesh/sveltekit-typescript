function Ue(){}function fo(i,t){for(const e in t)i[e]=t[e];return i}function po(i){return i&&typeof i=="object"&&typeof i.then=="function"}function ys(i){return i()}function Wn(){return Object.create(null)}function Ye(i){i.forEach(ys)}function yo(i){return typeof i=="function"}function mo(i,t){return i!=i?t==t:i!==t||i&&typeof i=="object"||typeof i=="function"}function _o(i){return Object.keys(i).length===0}function mu(i,t,e,n){if(i){const s=ms(i,t,e,n);return i[0](s)}}function ms(i,t,e,n){return i[1]&&n?fo(e.ctx.slice(),i[1](n(t))):e.ctx}function _u(i,t,e,n){if(i[2]&&n){const s=i[2](n(e));if(t.dirty===void 0)return s;if(typeof s=="object"){const r=[],o=Math.max(t.dirty.length,s.length);for(let a=0;a<o;a+=1)r[a]=t.dirty[a]|s[a];return r}return t.dirty|s}return t.dirty}function bu(i,t,e,n,s,r){if(s){const o=ms(t,e,n,r);i.p(o,s)}}function gu(i){if(i.ctx.length>32){const t=[],e=i.ctx.length/32;for(let n=0;n<e;n++)t[n]=-1;return t}return-1}let ki=!1;function bo(){ki=!0}function go(){ki=!1}function wo(i,t,e,n){for(;i<t;){const s=i+(t-i>>1);e(s)<=n?i=s+1:t=s}return i}function vo(i){if(i.hydrate_init)return;i.hydrate_init=!0;let t=i.childNodes;if(i.nodeName==="HEAD"){const c=[];for(let u=0;u<t.length;u++){const d=t[u];d.claim_order!==void 0&&c.push(d)}t=c}const e=new Int32Array(t.length+1),n=new Int32Array(t.length);e[0]=-1;let s=0;for(let c=0;c<t.length;c++){const u=t[c].claim_order,d=(s>0&&t[e[s]].claim_order<=u?s+1:wo(1,s,f=>t[e[f]].claim_order,u))-1;n[c]=e[d]+1;const h=d+1;e[h]=c,s=Math.max(h,s)}const r=[],o=[];let a=t.length-1;for(let c=e[s]+1;c!=0;c=n[c-1]){for(r.push(t[c-1]);a>=c;a--)o.push(t[a]);a--}for(;a>=0;a--)o.push(t[a]);r.reverse(),o.sort((c,u)=>c.claim_order-u.claim_order);for(let c=0,u=0;c<o.length;c++){for(;u<r.length&&o[c].claim_order>=r[u].claim_order;)u++;const d=u<r.length?r[u]:null;i.insertBefore(o[c],d)}}function Io(i,t){if(ki){for(vo(i),(i.actual_end_child===void 0||i.actual_end_child!==null&&i.actual_end_child.parentElement!==i)&&(i.actual_end_child=i.firstChild);i.actual_end_child!==null&&i.actual_end_child.claim_order===void 0;)i.actual_end_child=i.actual_end_child.nextSibling;t!==i.actual_end_child?(t.claim_order!==void 0||t.parentNode!==i)&&i.insertBefore(t,i.actual_end_child):i.actual_end_child=t.nextSibling}else(t.parentNode!==i||t.nextSibling!==null)&&i.appendChild(t)}function wu(i,t,e){ki&&!e?Io(i,t):(t.parentNode!==i||t.nextSibling!=e)&&i.insertBefore(t,e||null)}function So(i){i.parentNode.removeChild(i)}function vu(i,t){for(let e=0;e<i.length;e+=1)i[e]&&i[e].d(t)}function Ao(i){return document.createElement(i)}function hn(i){return document.createTextNode(i)}function Iu(){return hn(" ")}function Su(){return hn("")}function Au(i,t,e,n){return i.addEventListener(t,e,n),()=>i.removeEventListener(t,e,n)}function Fu(i,t,e){e==null?i.removeAttribute(t):i.getAttribute(t)!==e&&i.setAttribute(t,e)}function Fo(i){return Array.from(i.childNodes)}function Oo(i){i.claim_info===void 0&&(i.claim_info={last_index:0,total_claimed:0})}function _s(i,t,e,n,s=!1){Oo(i);const r=(()=>{for(let o=i.claim_info.last_index;o<i.length;o++){const a=i[o];if(t(a)){const c=e(a);return c===void 0?i.splice(o,1):i[o]=c,s||(i.claim_info.last_index=o),a}}for(let o=i.claim_info.last_index-1;o>=0;o--){const a=i[o];if(t(a)){const c=e(a);return c===void 0?i.splice(o,1):i[o]=c,s?c===void 0&&i.claim_info.last_index--:i.claim_info.last_index=o,a}}return n()})();return r.claim_order=i.claim_info.total_claimed,i.claim_info.total_claimed+=1,r}function To(i,t,e,n){return _s(i,s=>s.nodeName===t,s=>{const r=[];for(let o=0;o<s.attributes.length;o++){const a=s.attributes[o];e[a.name]||r.push(a.name)}r.forEach(o=>s.removeAttribute(o))},()=>n(t))}function Ou(i,t,e){return To(i,t,e,Ao)}function Bo(i,t){return _s(i,e=>e.nodeType===3,e=>{const n=""+t;if(e.data.startsWith(n)){if(e.data.length!==n.length)return e.splitText(n.length)}else e.data=n},()=>hn(t),!0)}function Tu(i){return Bo(i," ")}function Bu(i,t){t=""+t,i.wholeText!==t&&(i.data=t)}function Eu(i,t,e,n){e===null?i.style.removeProperty(t):i.style.setProperty(t,e,n?"important":"")}let xe;function jt(i){xe=i}function xi(){if(!xe)throw new Error("Function called outside component initialization");return xe}function Nu(i){xi().$$.on_mount.push(i)}function Du(i){xi().$$.after_update.push(i)}function Ru(i,t){xi().$$.context.set(i,t)}const Me=[],Gn=[],ti=[],Hn=[],bs=Promise.resolve();let qi=!1;function gs(){qi||(qi=!0,bs.then(fn))}function Lu(){return gs(),bs}function Zi(i){ti.push(i)}const Yi=new Set;let Qe=0;function fn(){const i=xe;do{for(;Qe<Me.length;){const t=Me[Qe];Qe++,jt(t),Eo(t.$$)}for(jt(null),Me.length=0,Qe=0;Gn.length;)Gn.pop()();for(let t=0;t<ti.length;t+=1){const e=ti[t];Yi.has(e)||(Yi.add(e),e())}ti.length=0}while(Me.length);for(;Hn.length;)Hn.pop()();qi=!1,Yi.clear(),jt(i)}function Eo(i){if(i.fragment!==null){i.update(),Ye(i.before_update);const t=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,t),i.after_update.forEach(Zi)}}const ei=new Set;let ne;function No(){ne={r:0,c:[],p:ne}}function Do(){ne.r||Ye(ne.c),ne=ne.p}function ws(i,t){i&&i.i&&(ei.delete(i),i.i(t))}function Ro(i,t,e,n){if(i&&i.o){if(ei.has(i))return;ei.add(i),ne.c.push(()=>{ei.delete(i),n&&(e&&i.d(1),n())}),i.o(t)}}function Mu(i,t){const e=t.token={};function n(s,r,o,a){if(t.token!==e)return;t.resolved=a;let c=t.ctx;o!==void 0&&(c=c.slice(),c[o]=a);const u=s&&(t.current=s)(c);let d=!1;t.block&&(t.blocks?t.blocks.forEach((h,f)=>{f!==r&&h&&(No(),Ro(h,1,1,()=>{t.blocks[f]===h&&(t.blocks[f]=null)}),Do())}):t.block.d(1),u.c(),ws(u,1),u.m(t.mount(),t.anchor),d=!0),t.block=u,t.blocks&&(t.blocks[r]=u),d&&fn()}if(po(i)){const s=xi();if(i.then(r=>{jt(s),n(t.then,1,t.value,r),jt(null)},r=>{if(jt(s),n(t.catch,2,t.error,r),jt(null),!t.hasCatch)throw r}),t.current!==t.pending)return n(t.pending,0),!0}else{if(t.current!==t.then)return n(t.then,1,t.value,i),!0;t.resolved=i}}function Uu(i,t,e){const n=t.slice(),{resolved:s}=i;i.current===i.then&&(n[i.value]=s),i.current===i.catch&&(n[i.error]=s),i.block.p(n,e)}function ku(i,t){const e={},n={},s={$$scope:1};let r=i.length;for(;r--;){const o=i[r],a=t[r];if(a){for(const c in o)c in a||(n[c]=1);for(const c in a)s[c]||(e[c]=a[c],s[c]=1);i[r]=a}else for(const c in o)s[c]=1}for(const o in n)o in e||(e[o]=void 0);return e}function xu(i){return typeof i=="object"&&i!==null?i:{}}function Cu(i){i&&i.c()}function Pu(i,t){i&&i.l(t)}function Lo(i,t,e,n){const{fragment:s,on_mount:r,on_destroy:o,after_update:a}=i.$$;s&&s.m(t,e),n||Zi(()=>{const c=r.map(ys).filter(yo);o?o.push(...c):Ye(c),i.$$.on_mount=[]}),a.forEach(Zi)}function Mo(i,t){const e=i.$$;e.fragment!==null&&(Ye(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function Uo(i,t){i.$$.dirty[0]===-1&&(Me.push(i),gs(),i.$$.dirty.fill(0)),i.$$.dirty[t/31|0]|=1<<t%31}function ju(i,t,e,n,s,r,o,a=[-1]){const c=xe;jt(i);const u=i.$$={fragment:null,ctx:null,props:r,update:Ue,not_equal:s,bound:Wn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:Wn(),dirty:a,skip_bound:!1,root:t.target||c.$$.root};o&&o(u.root);let d=!1;if(u.ctx=e?e(i,t.props||{},(h,f,...x)=>{const J=x.length?x[0]:f;return u.ctx&&s(u.ctx[h],u.ctx[h]=J)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](J),d&&Uo(i,h)),f}):[],u.update(),d=!0,Ye(u.before_update),u.fragment=n?n(u.ctx):!1,t.target){if(t.hydrate){bo();const h=Fo(t.target);u.fragment&&u.fragment.l(h),h.forEach(So)}else u.fragment&&u.fragment.c();t.intro&&ws(i.$$.fragment),Lo(i,t.target,t.anchor,t.customElement),go(),fn()}jt(c)}class Vu{$destroy(){Mo(this,1),this.$destroy=Ue}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const s=n.indexOf(e);s!==-1&&n.splice(s,1)}}$set(t){this.$$set&&!_o(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const me=[];function zu(i,t=Ue){let e;const n=new Set;function s(a){if(mo(i,a)&&(i=a,e)){const c=!me.length;for(const u of n)u[1](),me.push(u,i);if(c){for(let u=0;u<me.length;u+=2)me[u][0](me[u+1]);me.length=0}}}function r(a){s(a(i))}function o(a,c=Ue){const u=[a,c];return n.add(u),n.size===1&&(e=t(s)||Ue),a(i),()=>{n.delete(u),n.size===0&&(e(),e=null)}}return{set:s,update:r,subscribe:o}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function p(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(d){try{u(n.next(d))}catch(h){o(h)}}function c(d){try{u(n.throw(d))}catch(h){o(h)}}function u(d){d.done?r(d.value):s(d.value).then(a,c)}u((n=n.apply(i,t||[])).next())})}function Jn(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],n=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function A(i){return this instanceof A?(this.v=i,this):new A(i)}function Dt(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(i,t||[]),s,r=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){n[f]&&(s[f]=function(x){return new Promise(function(J,$i){r.push([f,x,J,$i])>1||a(f,x)})})}function a(f,x){try{c(n[f](x))}catch(J){h(r[0][3],J)}}function c(f){f.value instanceof A?Promise.resolve(f.value.v).then(u,d):h(r[0][2],f)}function u(f){a("next",f)}function d(f){a("throw",f)}function h(f,x){f(x),r.shift(),r.length&&a(r[0][0],r[0][1])}}function ii(i){var t,e;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,r){t[s]=i[s]?function(o){return(e=!e)?{value:A(i[s](o)),done:s==="return"}:r?r(o):o}:r}}function ue(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof Jn=="function"?Jn(i):i[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=i[r]&&function(o){return new Promise(function(a,c){o=i[r](o),s(a,c,o.done,o.value)})}}function s(r,o,a,c){Promise.resolve(c).then(function(u){r({value:u,done:a})},o)}}const ko=new TextDecoder("utf-8"),Xi=i=>ko.decode(i),xo=new TextEncoder,pn=i=>xo.encode(i),[$u,Co]=(()=>{const i=()=>{throw new Error("BigInt is not available in this environment")};function t(){throw i()}return t.asIntN=()=>{throw i()},t.asUintN=()=>{throw i()},typeof BigInt!="undefined"?[BigInt,!0]:[t,!1]})(),[vs,Yu]=(()=>{const i=()=>{throw new Error("BigInt64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw i()}static from(){throw i()}constructor(){throw i()}}return typeof BigInt64Array!="undefined"?[BigInt64Array,!0]:[t,!1]})(),[Is,Wu]=(()=>{const i=()=>{throw new Error("BigUint64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw i()}static from(){throw i()}constructor(){throw i()}}return typeof BigUint64Array!="undefined"?[BigUint64Array,!0]:[t,!1]})(),Po=i=>typeof i=="number",Ss=i=>typeof i=="boolean",Y=i=>typeof i=="function",st=i=>i!=null&&Object(i)===i,he=i=>st(i)&&Y(i.then),We=i=>st(i)&&Y(i[Symbol.iterator]),De=i=>st(i)&&Y(i[Symbol.asyncIterator]),tn=i=>st(i)&&st(i.schema),As=i=>st(i)&&"done"in i&&"value"in i,Fs=i=>st(i)&&Y(i.stat)&&Po(i.fd),Os=i=>st(i)&&yn(i.body),Ci=i=>"_getDOMStream"in i&&"_getNodeStream"in i,jo=i=>st(i)&&Y(i.abort)&&Y(i.getWriter)&&!Ci(i),yn=i=>st(i)&&Y(i.cancel)&&Y(i.getReader)&&!Ci(i),Vo=i=>st(i)&&Y(i.end)&&Y(i.write)&&Ss(i.writable)&&!Ci(i),Ts=i=>st(i)&&Y(i.read)&&Y(i.pipe)&&Ss(i.readable)&&!Ci(i),zo=i=>st(i)&&Y(i.clear)&&Y(i.bytes)&&Y(i.position)&&Y(i.setPosition)&&Y(i.capacity)&&Y(i.getBufferIdentifier)&&Y(i.createLong),mn=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:ArrayBuffer;function $o(i){const t=i[0]?[i[0]]:[];let e,n,s,r;for(let o,a,c=0,u=0,d=i.length;++c<d;){if(o=t[u],a=i[c],!o||!a||o.buffer!==a.buffer||a.byteOffset<o.byteOffset){a&&(t[++u]=a);continue}if({byteOffset:e,byteLength:s}=o,{byteOffset:n,byteLength:r}=a,e+s<n||n+r<e){a&&(t[++u]=a);continue}t[u]=new Uint8Array(o.buffer,e,n-e+r)}return t}function Kn(i,t,e=0,n=t.byteLength){const s=i.byteLength,r=new Uint8Array(i.buffer,i.byteOffset,s),o=new Uint8Array(t.buffer,t.byteOffset,Math.min(n,s));return r.set(o,e),i}function Lt(i,t){const e=$o(i),n=e.reduce((d,h)=>d+h.byteLength,0);let s,r,o,a=0,c=-1;const u=Math.min(t||Number.POSITIVE_INFINITY,n);for(const d=e.length;++c<d;){if(s=e[c],r=s.subarray(0,Math.min(s.length,u-a)),u<=a+r.length){r.length<s.length?e[c]=s.subarray(r.length):r.length===s.length&&c++,o?Kn(o,r,a):o=r;break}Kn(o||(o=new Uint8Array(u)),r,a),a+=r.length}return[o||new Uint8Array(0),e.slice(c),n-(o?o.byteLength:0)]}function U(i,t){let e=As(t)?t.value:t;return e instanceof i?i===Uint8Array?new i(e.buffer,e.byteOffset,e.byteLength):e:e?(typeof e=="string"&&(e=pn(e)),e instanceof ArrayBuffer?new i(e):e instanceof mn?new i(e):zo(e)?U(i,e.bytes()):ArrayBuffer.isView(e)?e.byteLength<=0?new i(0):new i(e.buffer,e.byteOffset,e.byteLength/i.BYTES_PER_ELEMENT):i.from(e)):new i(0)}const Le=i=>U(Int32Array,i),E=i=>U(Uint8Array,i),en=i=>(i.next(),i);function*Yo(i,t){const e=function*(s){yield s},n=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof mn?e(t):We(t)?t:e(t);return yield*en(function*(s){let r=null;do r=s.next(yield U(i,r));while(!r.done)}(n[Symbol.iterator]())),new i}const Wo=i=>Yo(Uint8Array,i);function Bs(i,t){return Dt(this,arguments,function*(){if(he(t))return yield A(yield A(yield*ii(ue(Bs(i,yield A(t))))));const n=function(o){return Dt(this,arguments,function*(){yield yield A(yield A(o))})},s=function(o){return Dt(this,arguments,function*(){yield A(yield*ii(ue(en(function*(a){let c=null;do c=a.next(yield c==null?void 0:c.value);while(!c.done)}(o[Symbol.iterator]())))))})},r=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof mn?n(t):We(t)?s(t):De(t)?t:n(t);return yield A(yield*ii(ue(en(function(o){return Dt(this,arguments,function*(){let a=null;do a=yield A(o.next(yield yield A(U(i,a))));while(!a.done)})}(r[Symbol.asyncIterator]()))))),yield A(new i)})}const Go=i=>Bs(Uint8Array,i);function _n(i,t,e){if(i!==0){e=e.slice(0,t+1);for(let n=-1;++n<=t;)e[n]+=i}return e}function Ho(i,t){let e=0;const n=i.length;if(n!==t.length)return!1;if(n>0)do if(i[e]!==t[e])return!1;while(++e<n);return!0}var ht={fromIterable(i){return qe(Jo(i))},fromAsyncIterable(i){return qe(Ko(i))},fromDOMStream(i){return qe(Qo(i))},fromNodeStream(i){return qe(Zo(i))},toDOMStream(i,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(i,t){throw new Error('"toNodeStream" not available in this environment')}};const qe=i=>(i.next(),i);function*Jo(i){let t,e=!1,n=[],s,r,o,a=0;function c(){return r==="peek"?Lt(n,o)[0]:([s,n,a]=Lt(n,o),s)}({cmd:r,size:o}=yield null);const u=Wo(i)[Symbol.iterator]();try{do if({done:t,value:s}=Number.isNaN(o-a)?u.next():u.next(o-a),!t&&s.byteLength>0&&(n.push(s),a+=s.byteLength),t||o<=a)do({cmd:r,size:o}=yield c());while(o<a);while(!t)}catch(d){(e=!0)&&typeof u.throw=="function"&&u.throw(d)}finally{e===!1&&typeof u.return=="function"&&u.return(null)}return null}function Ko(i){return Dt(this,arguments,function*(){let e,n=!1,s=[],r,o,a,c=0;function u(){return o==="peek"?Lt(s,a)[0]:([r,s,c]=Lt(s,a),r)}({cmd:o,size:a}=yield yield A(null));const d=Go(i)[Symbol.asyncIterator]();try{do if({done:e,value:r}=Number.isNaN(a-c)?yield A(d.next()):yield A(d.next(a-c)),!e&&r.byteLength>0&&(s.push(r),c+=r.byteLength),e||a<=c)do({cmd:o,size:a}=yield yield A(u()));while(a<c);while(!e)}catch(h){(n=!0)&&typeof d.throw=="function"&&(yield A(d.throw(h)))}finally{n===!1&&typeof d.return=="function"&&(yield A(d.return(new Uint8Array(0))))}return yield A(null)})}function Qo(i){return Dt(this,arguments,function*(){let e=!1,n=!1,s=[],r,o,a,c=0;function u(){return o==="peek"?Lt(s,a)[0]:([r,s,c]=Lt(s,a),r)}({cmd:o,size:a}=yield yield A(null));const d=new qo(i);try{do if({done:e,value:r}=Number.isNaN(a-c)?yield A(d.read()):yield A(d.read(a-c)),!e&&r.byteLength>0&&(s.push(E(r)),c+=r.byteLength),e||a<=c)do({cmd:o,size:a}=yield yield A(u()));while(a<c);while(!e)}catch(h){(n=!0)&&(yield A(d.cancel(h)))}finally{n===!1?yield A(d.cancel()):i.locked&&d.releaseLock()}return yield A(null)})}class qo{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return p(this,void 0,void 0,function*(){const{reader:e,source:n}=this;e&&(yield e.cancel(t).catch(()=>{})),n&&n.locked&&this.releaseLock()})}read(t){return p(this,void 0,void 0,function*(){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};const e=yield this.reader.read();return!e.done&&(e.value=E(e)),e})}}const Wi=(i,t)=>{const e=s=>n([t,s]);let n;return[t,e,new Promise(s=>(n=s)&&i.once(t,e))]};function Zo(i){return Dt(this,arguments,function*(){const e=[];let n="error",s=!1,r=null,o,a,c=0,u=[],d;function h(){return o==="peek"?Lt(u,a)[0]:([d,u,c]=Lt(u,a),d)}if({cmd:o,size:a}=yield yield A(null),i.isTTY)return yield yield A(new Uint8Array(0)),yield A(null);try{e[0]=Wi(i,"end"),e[1]=Wi(i,"error");do{if(e[2]=Wi(i,"readable"),[n,r]=yield A(Promise.race(e.map(x=>x[2]))),n==="error")break;if((s=n==="end")||(Number.isFinite(a-c)?(d=E(i.read(a-c)),d.byteLength<a-c&&(d=E(i.read()))):d=E(i.read()),d.byteLength>0&&(u.push(d),c+=d.byteLength)),s||a<=c)do({cmd:o,size:a}=yield yield A(h()));while(a<c)}while(!s)}finally{yield A(f(e,n==="error"?r:null))}return yield A(null);function f(x,J){return d=u=null,new Promise(($i,uo)=>{for(const[ye,ho]of x)i.off(ye,ho);try{const ye=i.destroy;ye&&ye.call(i,J),J=void 0}catch(ye){J=ye||J}finally{J!=null?uo(J):$i()}})}})}var lt;(function(i){i[i.V1=0]="V1",i[i.V2=1]="V2",i[i.V3=2]="V3",i[i.V4=3]="V4",i[i.V5=4]="V5"})(lt||(lt={}));var ut;(function(i){i[i.Sparse=0]="Sparse",i[i.Dense=1]="Dense"})(ut||(ut={}));var K;(function(i){i[i.HALF=0]="HALF",i[i.SINGLE=1]="SINGLE",i[i.DOUBLE=2]="DOUBLE"})(K||(K={}));var Vt;(function(i){i[i.DAY=0]="DAY",i[i.MILLISECOND=1]="MILLISECOND"})(Vt||(Vt={}));var N;(function(i){i[i.SECOND=0]="SECOND",i[i.MILLISECOND=1]="MILLISECOND",i[i.MICROSECOND=2]="MICROSECOND",i[i.NANOSECOND=3]="NANOSECOND"})(N||(N={}));var Gt;(function(i){i[i.YEAR_MONTH=0]="YEAR_MONTH",i[i.DAY_TIME=1]="DAY_TIME",i[i.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Gt||(Gt={}));var D;(function(i){i[i.NONE=0]="NONE",i[i.Schema=1]="Schema",i[i.DictionaryBatch=2]="DictionaryBatch",i[i.RecordBatch=3]="RecordBatch",i[i.Tensor=4]="Tensor",i[i.SparseTensor=5]="SparseTensor"})(D||(D={}));var l;(function(i){i[i.NONE=0]="NONE",i[i.Null=1]="Null",i[i.Int=2]="Int",i[i.Float=3]="Float",i[i.Binary=4]="Binary",i[i.Utf8=5]="Utf8",i[i.Bool=6]="Bool",i[i.Decimal=7]="Decimal",i[i.Date=8]="Date",i[i.Time=9]="Time",i[i.Timestamp=10]="Timestamp",i[i.Interval=11]="Interval",i[i.List=12]="List",i[i.Struct=13]="Struct",i[i.Union=14]="Union",i[i.FixedSizeBinary=15]="FixedSizeBinary",i[i.FixedSizeList=16]="FixedSizeList",i[i.Map=17]="Map",i[i.Dictionary=-1]="Dictionary",i[i.Int8=-2]="Int8",i[i.Int16=-3]="Int16",i[i.Int32=-4]="Int32",i[i.Int64=-5]="Int64",i[i.Uint8=-6]="Uint8",i[i.Uint16=-7]="Uint16",i[i.Uint32=-8]="Uint32",i[i.Uint64=-9]="Uint64",i[i.Float16=-10]="Float16",i[i.Float32=-11]="Float32",i[i.Float64=-12]="Float64",i[i.DateDay=-13]="DateDay",i[i.DateMillisecond=-14]="DateMillisecond",i[i.TimestampSecond=-15]="TimestampSecond",i[i.TimestampMillisecond=-16]="TimestampMillisecond",i[i.TimestampMicrosecond=-17]="TimestampMicrosecond",i[i.TimestampNanosecond=-18]="TimestampNanosecond",i[i.TimeSecond=-19]="TimeSecond",i[i.TimeMillisecond=-20]="TimeMillisecond",i[i.TimeMicrosecond=-21]="TimeMicrosecond",i[i.TimeNanosecond=-22]="TimeNanosecond",i[i.DenseUnion=-23]="DenseUnion",i[i.SparseUnion=-24]="SparseUnion",i[i.IntervalDayTime=-25]="IntervalDayTime",i[i.IntervalYearMonth=-26]="IntervalYearMonth"})(l||(l={}));var Ut;(function(i){i[i.OFFSET=0]="OFFSET",i[i.DATA=1]="DATA",i[i.VALIDITY=2]="VALIDITY",i[i.TYPE=3]="TYPE"})(Ut||(Ut={}));const Xo=void 0;function Ce(i){if(i===null)return"null";if(i===Xo)return"undefined";switch(typeof i){case"number":return`${i}`;case"bigint":return`${i}`;case"string":return`"${i}"`}return typeof i[Symbol.toPrimitive]=="function"?i[Symbol.toPrimitive]("string"):ArrayBuffer.isView(i)?i instanceof BigInt64Array||i instanceof BigUint64Array?`[${[...i].map(t=>Ce(t))}]`:`[${i}]`:ArrayBuffer.isView(i)?`[${i}]`:JSON.stringify(i,(t,e)=>typeof e=="bigint"?`${e}`:e)}const ta=Symbol.for("isArrowBigNum");function vt(i,...t){return t.length===0?Object.setPrototypeOf(U(this.TypedArray,i),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(i,...t),this.constructor.prototype)}vt.prototype[ta]=!0;vt.prototype.toJSON=function(){return`"${de(this)}"`};vt.prototype.valueOf=function(){return Es(this)};vt.prototype.toString=function(){return de(this)};vt.prototype[Symbol.toPrimitive]=function(i="default"){switch(i){case"number":return Es(this);case"string":return de(this);case"default":return nn(this)}return de(this)};function we(...i){return vt.apply(this,i)}function ve(...i){return vt.apply(this,i)}function Pe(...i){return vt.apply(this,i)}Object.setPrototypeOf(we.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(ve.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(Pe.prototype,Object.create(Uint32Array.prototype));Object.assign(we.prototype,vt.prototype,{constructor:we,signed:!0,TypedArray:Int32Array,BigIntArray:vs});Object.assign(ve.prototype,vt.prototype,{constructor:ve,signed:!1,TypedArray:Uint32Array,BigIntArray:Is});Object.assign(Pe.prototype,vt.prototype,{constructor:Pe,signed:!0,TypedArray:Uint32Array,BigIntArray:Is});function Es(i){const{buffer:t,byteOffset:e,length:n,signed:s}=i,r=new Int32Array(t,e,n);let o=0,a=0;const c=r.length;let u,d;for(;a<c;)d=r[a++],u=r[a++],s||(u=u>>>0),o+=(d>>>0)+u*Math.pow(a,32);return o}let de,nn;Co?(nn=i=>i.byteLength===8?new i.BigIntArray(i.buffer,i.byteOffset,1)[0]:Gi(i),de=i=>i.byteLength===8?`${new i.BigIntArray(i.buffer,i.byteOffset,1)[0]}`:Gi(i)):(de=Gi,nn=de);function Gi(i){let t="";const e=new Uint32Array(2);let n=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2);const s=new Uint32Array((n=new Uint16Array(n).reverse()).buffer);let r=-1;const o=n.length-1;do{for(e[0]=n[r=0];r<o;)n[r++]=e[1]=e[0]/10,e[0]=(e[0]-e[1]*10<<16)+n[r];n[r]=e[1]=e[0]/10,e[0]=e[0]-e[1]*10,t=`${e[0]}${t}`}while(s[0]||s[1]||s[2]||s[3]);return t||"0"}class bn{static new(t,e){switch(e){case!0:return new we(t);case!1:return new ve(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case vs:return new we(t)}return t.byteLength===16?new Pe(t):new ve(t)}static signed(t){return new we(t)}static unsigned(t){return new ve(t)}static decimal(t){return new Pe(t)}constructor(t,e){return bn.new(t,e)}}var Ns,Ds,Rs,Ls,Ms,Us,ks,xs,Cs,Ps,js,Vs,zs,$s,Ys,Ws,Gs,Hs,Js;class y{static isNull(t){return(t==null?void 0:t.typeId)===l.Null}static isInt(t){return(t==null?void 0:t.typeId)===l.Int}static isFloat(t){return(t==null?void 0:t.typeId)===l.Float}static isBinary(t){return(t==null?void 0:t.typeId)===l.Binary}static isUtf8(t){return(t==null?void 0:t.typeId)===l.Utf8}static isBool(t){return(t==null?void 0:t.typeId)===l.Bool}static isDecimal(t){return(t==null?void 0:t.typeId)===l.Decimal}static isDate(t){return(t==null?void 0:t.typeId)===l.Date}static isTime(t){return(t==null?void 0:t.typeId)===l.Time}static isTimestamp(t){return(t==null?void 0:t.typeId)===l.Timestamp}static isInterval(t){return(t==null?void 0:t.typeId)===l.Interval}static isList(t){return(t==null?void 0:t.typeId)===l.List}static isStruct(t){return(t==null?void 0:t.typeId)===l.Struct}static isUnion(t){return(t==null?void 0:t.typeId)===l.Union}static isFixedSizeBinary(t){return(t==null?void 0:t.typeId)===l.FixedSizeBinary}static isFixedSizeList(t){return(t==null?void 0:t.typeId)===l.FixedSizeList}static isMap(t){return(t==null?void 0:t.typeId)===l.Map}static isDictionary(t){return(t==null?void 0:t.typeId)===l.Dictionary}static isDenseUnion(t){return y.isUnion(t)&&t.mode===ut.Dense}static isSparseUnion(t){return y.isUnion(t)&&t.mode===ut.Sparse}get typeId(){return l.NONE}}Ns=Symbol.toStringTag;y[Ns]=(i=>(i.children=null,i.ArrayType=Array,i[Symbol.toStringTag]="DataType"))(y.prototype);class Ht extends y{toString(){return"Null"}get typeId(){return l.Null}}Ds=Symbol.toStringTag;Ht[Ds]=(i=>i[Symbol.toStringTag]="Null")(Ht.prototype);class tt extends y{constructor(t,e){super();this.isSigned=t,this.bitWidth=e}get typeId(){return l.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}Rs=Symbol.toStringTag;tt[Rs]=(i=>(i.isSigned=null,i.bitWidth=null,i[Symbol.toStringTag]="Int"))(tt.prototype);class ea extends tt{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}class ia extends tt{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}class je extends tt{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}class na extends tt{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}class sa extends tt{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}class ra extends tt{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}class oa extends tt{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}class aa extends tt{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}Object.defineProperty(ea.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(ia.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(je.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(na.prototype,"ArrayType",{value:BigInt64Array});Object.defineProperty(sa.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(ra.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(oa.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(aa.prototype,"ArrayType",{value:BigUint64Array});class Jt extends y{constructor(t){super();this.precision=t}get typeId(){return l.Float}get ArrayType(){switch(this.precision){case K.HALF:return Uint16Array;case K.SINGLE:return Float32Array;case K.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}Ls=Symbol.toStringTag;Jt[Ls]=(i=>(i.precision=null,i[Symbol.toStringTag]="Float"))(Jt.prototype);class ca extends Jt{constructor(){super(K.HALF)}}class la extends Jt{constructor(){super(K.SINGLE)}}class ua extends Jt{constructor(){super(K.DOUBLE)}}Object.defineProperty(ca.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(la.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(ua.prototype,"ArrayType",{value:Float64Array});class oi extends y{constructor(){super()}get typeId(){return l.Binary}toString(){return"Binary"}}Ms=Symbol.toStringTag;oi[Ms]=(i=>(i.ArrayType=Uint8Array,i[Symbol.toStringTag]="Binary"))(oi.prototype);class ai extends y{constructor(){super()}get typeId(){return l.Utf8}toString(){return"Utf8"}}Us=Symbol.toStringTag;ai[Us]=(i=>(i.ArrayType=Uint8Array,i[Symbol.toStringTag]="Utf8"))(ai.prototype);class ci extends y{constructor(){super()}get typeId(){return l.Bool}toString(){return"Bool"}}ks=Symbol.toStringTag;ci[ks]=(i=>(i.ArrayType=Uint8Array,i[Symbol.toStringTag]="Bool"))(ci.prototype);class li extends y{constructor(t,e,n=128){super();this.scale=t,this.precision=e,this.bitWidth=n}get typeId(){return l.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}xs=Symbol.toStringTag;li[xs]=(i=>(i.scale=null,i.precision=null,i.ArrayType=Uint32Array,i[Symbol.toStringTag]="Decimal"))(li.prototype);class ui extends y{constructor(t){super();this.unit=t}get typeId(){return l.Date}toString(){return`Date${(this.unit+1)*32}<${Vt[this.unit]}>`}}Cs=Symbol.toStringTag;ui[Cs]=(i=>(i.unit=null,i.ArrayType=Int32Array,i[Symbol.toStringTag]="Date"))(ui.prototype);class Ve extends y{constructor(t,e){super();this.unit=t,this.bitWidth=e}get typeId(){return l.Time}toString(){return`Time${this.bitWidth}<${N[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}Ps=Symbol.toStringTag;Ve[Ps]=(i=>(i.unit=null,i.bitWidth=null,i[Symbol.toStringTag]="Time"))(Ve.prototype);class di extends y{constructor(t,e){super();this.unit=t,this.timezone=e}get typeId(){return l.Timestamp}toString(){return`Timestamp<${N[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}js=Symbol.toStringTag;di[js]=(i=>(i.unit=null,i.timezone=null,i.ArrayType=Int32Array,i[Symbol.toStringTag]="Timestamp"))(di.prototype);class hi extends y{constructor(t){super();this.unit=t}get typeId(){return l.Interval}toString(){return`Interval<${Gt[this.unit]}>`}}Vs=Symbol.toStringTag;hi[Vs]=(i=>(i.unit=null,i.ArrayType=Int32Array,i[Symbol.toStringTag]="Interval"))(hi.prototype);class fi extends y{constructor(t){super();this.children=[t]}get typeId(){return l.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}zs=Symbol.toStringTag;fi[zs]=(i=>(i.children=null,i[Symbol.toStringTag]="List"))(fi.prototype);class Z extends y{constructor(t){super();this.children=t}get typeId(){return l.Struct}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}}$s=Symbol.toStringTag;Z[$s]=(i=>(i.children=null,i[Symbol.toStringTag]="Struct"))(Z.prototype);class pi extends y{constructor(t,e,n){super();this.mode=t,this.children=n,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce((s,r,o)=>(s[r]=o)&&s||s,Object.create(null))}get typeId(){return l.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}}Ys=Symbol.toStringTag;pi[Ys]=(i=>(i.mode=null,i.typeIds=null,i.children=null,i.typeIdToChildIndex=null,i.ArrayType=Int8Array,i[Symbol.toStringTag]="Union"))(pi.prototype);class yi extends y{constructor(t){super();this.byteWidth=t}get typeId(){return l.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}Ws=Symbol.toStringTag;yi[Ws]=(i=>(i.byteWidth=null,i.ArrayType=Uint8Array,i[Symbol.toStringTag]="FixedSizeBinary"))(yi.prototype);class mi extends y{constructor(t,e){super();this.listSize=t,this.children=[e]}get typeId(){return l.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}Gs=Symbol.toStringTag;mi[Gs]=(i=>(i.children=null,i.listSize=null,i[Symbol.toStringTag]="FixedSizeList"))(mi.prototype);class _i extends y{constructor(t,e=!1){super();this.children=[t],this.keysSorted=e}get typeId(){return l.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}}Hs=Symbol.toStringTag;_i[Hs]=(i=>(i.children=null,i.keysSorted=null,i[Symbol.toStringTag]="Map_"))(_i.prototype);const da=(i=>()=>++i)(-1);class Fe extends y{constructor(t,e,n,s){super();this.indices=e,this.dictionary=t,this.isOrdered=s||!1,this.id=n==null?da():typeof n=="number"?n:n.low}get typeId(){return l.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}Js=Symbol.toStringTag;Fe[Js]=(i=>(i.id=null,i.indices=null,i.isOrdered=null,i.dictionary=null,i[Symbol.toStringTag]="Dictionary"))(Fe.prototype);function kt(i){const t=i;switch(i.typeId){case l.Decimal:return i.bitWidth/32;case l.Timestamp:return 2;case l.Date:return 1+t.unit;case l.Interval:return 1+t.unit;case l.FixedSizeList:return t.listSize;case l.FixedSizeBinary:return t.byteWidth;default:return 1}}class T{visitMany(t,...e){return t.map((n,s)=>this.visit(n,...e.map(r=>r[s])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,e=!0){return ha(this,t,e)}getVisitFnByTypeId(t,e=!0){return be(this,t,e)}visitNull(t,...e){return null}visitBool(t,...e){return null}visitInt(t,...e){return null}visitFloat(t,...e){return null}visitUtf8(t,...e){return null}visitBinary(t,...e){return null}visitFixedSizeBinary(t,...e){return null}visitDate(t,...e){return null}visitTimestamp(t,...e){return null}visitTime(t,...e){return null}visitDecimal(t,...e){return null}visitList(t,...e){return null}visitStruct(t,...e){return null}visitUnion(t,...e){return null}visitDictionary(t,...e){return null}visitInterval(t,...e){return null}visitFixedSizeList(t,...e){return null}visitMap(t,...e){return null}}function ha(i,t,e=!0){return typeof t=="number"?be(i,t,e):typeof t=="string"&&t in l?be(i,l[t],e):t&&t instanceof y?be(i,Qn(t),e):(t==null?void 0:t.type)&&t.type instanceof y?be(i,Qn(t.type),e):be(i,l.NONE,e)}function be(i,t,e=!0){let n=null;switch(t){case l.Null:n=i.visitNull;break;case l.Bool:n=i.visitBool;break;case l.Int:n=i.visitInt;break;case l.Int8:n=i.visitInt8||i.visitInt;break;case l.Int16:n=i.visitInt16||i.visitInt;break;case l.Int32:n=i.visitInt32||i.visitInt;break;case l.Int64:n=i.visitInt64||i.visitInt;break;case l.Uint8:n=i.visitUint8||i.visitInt;break;case l.Uint16:n=i.visitUint16||i.visitInt;break;case l.Uint32:n=i.visitUint32||i.visitInt;break;case l.Uint64:n=i.visitUint64||i.visitInt;break;case l.Float:n=i.visitFloat;break;case l.Float16:n=i.visitFloat16||i.visitFloat;break;case l.Float32:n=i.visitFloat32||i.visitFloat;break;case l.Float64:n=i.visitFloat64||i.visitFloat;break;case l.Utf8:n=i.visitUtf8;break;case l.Binary:n=i.visitBinary;break;case l.FixedSizeBinary:n=i.visitFixedSizeBinary;break;case l.Date:n=i.visitDate;break;case l.DateDay:n=i.visitDateDay||i.visitDate;break;case l.DateMillisecond:n=i.visitDateMillisecond||i.visitDate;break;case l.Timestamp:n=i.visitTimestamp;break;case l.TimestampSecond:n=i.visitTimestampSecond||i.visitTimestamp;break;case l.TimestampMillisecond:n=i.visitTimestampMillisecond||i.visitTimestamp;break;case l.TimestampMicrosecond:n=i.visitTimestampMicrosecond||i.visitTimestamp;break;case l.TimestampNanosecond:n=i.visitTimestampNanosecond||i.visitTimestamp;break;case l.Time:n=i.visitTime;break;case l.TimeSecond:n=i.visitTimeSecond||i.visitTime;break;case l.TimeMillisecond:n=i.visitTimeMillisecond||i.visitTime;break;case l.TimeMicrosecond:n=i.visitTimeMicrosecond||i.visitTime;break;case l.TimeNanosecond:n=i.visitTimeNanosecond||i.visitTime;break;case l.Decimal:n=i.visitDecimal;break;case l.List:n=i.visitList;break;case l.Struct:n=i.visitStruct;break;case l.Union:n=i.visitUnion;break;case l.DenseUnion:n=i.visitDenseUnion||i.visitUnion;break;case l.SparseUnion:n=i.visitSparseUnion||i.visitUnion;break;case l.Dictionary:n=i.visitDictionary;break;case l.Interval:n=i.visitInterval;break;case l.IntervalDayTime:n=i.visitIntervalDayTime||i.visitInterval;break;case l.IntervalYearMonth:n=i.visitIntervalYearMonth||i.visitInterval;break;case l.FixedSizeList:n=i.visitFixedSizeList;break;case l.Map:n=i.visitMap;break}if(typeof n=="function")return n;if(!e)return()=>null;throw new Error(`Unrecognized type '${l[t]}'`)}function Qn(i){switch(i.typeId){case l.Null:return l.Null;case l.Int:{const{bitWidth:t,isSigned:e}=i;switch(t){case 8:return e?l.Int8:l.Uint8;case 16:return e?l.Int16:l.Uint16;case 32:return e?l.Int32:l.Uint32;case 64:return e?l.Int64:l.Uint64}return l.Int}case l.Float:switch(i.precision){case K.HALF:return l.Float16;case K.SINGLE:return l.Float32;case K.DOUBLE:return l.Float64}return l.Float;case l.Binary:return l.Binary;case l.Utf8:return l.Utf8;case l.Bool:return l.Bool;case l.Decimal:return l.Decimal;case l.Time:switch(i.unit){case N.SECOND:return l.TimeSecond;case N.MILLISECOND:return l.TimeMillisecond;case N.MICROSECOND:return l.TimeMicrosecond;case N.NANOSECOND:return l.TimeNanosecond}return l.Time;case l.Timestamp:switch(i.unit){case N.SECOND:return l.TimestampSecond;case N.MILLISECOND:return l.TimestampMillisecond;case N.MICROSECOND:return l.TimestampMicrosecond;case N.NANOSECOND:return l.TimestampNanosecond}return l.Timestamp;case l.Date:switch(i.unit){case Vt.DAY:return l.DateDay;case Vt.MILLISECOND:return l.DateMillisecond}return l.Date;case l.Interval:switch(i.unit){case Gt.DAY_TIME:return l.IntervalDayTime;case Gt.YEAR_MONTH:return l.IntervalYearMonth}return l.Interval;case l.Map:return l.Map;case l.List:return l.List;case l.Struct:return l.Struct;case l.Union:switch(i.mode){case ut.Dense:return l.DenseUnion;case ut.Sparse:return l.SparseUnion}return l.Union;case l.FixedSizeBinary:return l.FixedSizeBinary;case l.FixedSizeList:return l.FixedSizeList;case l.Dictionary:return l.Dictionary}throw new Error(`Unrecognized type '${l[i.typeId]}'`)}T.prototype.visitInt8=null;T.prototype.visitInt16=null;T.prototype.visitInt32=null;T.prototype.visitInt64=null;T.prototype.visitUint8=null;T.prototype.visitUint16=null;T.prototype.visitUint32=null;T.prototype.visitUint64=null;T.prototype.visitFloat16=null;T.prototype.visitFloat32=null;T.prototype.visitFloat64=null;T.prototype.visitDateDay=null;T.prototype.visitDateMillisecond=null;T.prototype.visitTimestampSecond=null;T.prototype.visitTimestampMillisecond=null;T.prototype.visitTimestampMicrosecond=null;T.prototype.visitTimestampNanosecond=null;T.prototype.visitTimeSecond=null;T.prototype.visitTimeMillisecond=null;T.prototype.visitTimeMicrosecond=null;T.prototype.visitTimeNanosecond=null;T.prototype.visitDenseUnion=null;T.prototype.visitSparseUnion=null;T.prototype.visitIntervalDayTime=null;T.prototype.visitIntervalYearMonth=null;const Ks=new Float64Array(1),_e=new Uint32Array(Ks.buffer);function Qs(i){const t=(i&31744)>>10,e=(i&1023)/1024,n=Math.pow(-1,(i&32768)>>15);switch(t){case 31:return n*(e?Number.NaN:1/0);case 0:return n*(e?6103515625e-14*e:0)}return n*Math.pow(2,t-15)*(1+e)}function fa(i){if(i!==i)return 32256;Ks[0]=i;const t=(_e[1]&2147483648)>>16&65535;let e=_e[1]&2146435072,n=0;return e>=1089470464?_e[0]>0?e=31744:(e=(e&2080374784)>>16,n=(_e[1]&1048575)>>10):e<=1056964608?(n=1048576+(_e[1]&1048575),n=1048576+(n<<(e>>20)-998)>>21,e=0):(e=e-1056964608>>10,n=(_e[1]&1048575)+512>>10),t|e|n&65535}class w extends T{}function S(i){return(t,e,n)=>{if(t.setValid(e,n!=null))return i(t,e,n)}}const pa=(i,t,e)=>{i[t]=Math.trunc(e/864e5)},gn=(i,t,e)=>{i[t]=Math.trunc(e%4294967296),i[t+1]=Math.trunc(e/4294967296)},ya=(i,t,e)=>{i[t]=Math.trunc(e*1e3%4294967296),i[t+1]=Math.trunc(e*1e3/4294967296)},ma=(i,t,e)=>{i[t]=Math.trunc(e*1e6%4294967296),i[t+1]=Math.trunc(e*1e6/4294967296)},qs=(i,t,e,n)=>{const{[e]:s,[e+1]:r}=t;s!=null&&r!=null&&i.set(n.subarray(0,r-s),s)},_a=({offset:i,values:t},e,n)=>{const s=i+e;n?t[s>>3]|=1<<s%8:t[s>>3]&=~(1<<s%8)},zt=({values:i},t,e)=>{i[t]=e},wn=({values:i},t,e)=>{i[t]=e},Zs=({values:i},t,e)=>{i[t]=fa(e)},ba=(i,t,e)=>{switch(i.type.precision){case K.HALF:return Zs(i,t,e);case K.SINGLE:case K.DOUBLE:default:return wn(i,t,e)}},Xs=({values:i},t,e)=>{pa(i,t,e.valueOf())},tr=({values:i},t,e)=>{gn(i,t*2,e.valueOf())},ga=({stride:i,values:t},e,n)=>{t.set(n.subarray(0,i),i*e)},wa=({values:i,valueOffsets:t},e,n)=>qs(i,t,e,n),va=({values:i,valueOffsets:t},e,n)=>{qs(i,t,e,pn(n))},Ia=(i,t,e)=>{i.type.unit===Vt.DAY?Xs(i,t,e):tr(i,t,e)},er=({values:i},t,e)=>gn(i,t*2,e/1e3),ir=({values:i},t,e)=>gn(i,t*2,e),nr=({values:i},t,e)=>ya(i,t*2,e),sr=({values:i},t,e)=>ma(i,t*2,e),Sa=(i,t,e)=>{switch(i.type.unit){case N.SECOND:return er(i,t,e);case N.MILLISECOND:return ir(i,t,e);case N.MICROSECOND:return nr(i,t,e);case N.NANOSECOND:return sr(i,t,e)}},rr=({values:i},t,e)=>{i[t]=e},or=({values:i},t,e)=>{i[t]=e},ar=({values:i},t,e)=>{i[t]=e},cr=({values:i},t,e)=>{i[t]=e},Aa=(i,t,e)=>{switch(i.type.unit){case N.SECOND:return rr(i,t,e);case N.MILLISECOND:return or(i,t,e);case N.MICROSECOND:return ar(i,t,e);case N.NANOSECOND:return cr(i,t,e)}},Fa=({values:i,stride:t},e,n)=>{i.set(n.subarray(0,t),t*e)},Oa=(i,t,e)=>{const n=i.children[0],s=i.valueOffsets,r=bt.getVisitFn(n);if(Array.isArray(e))for(let o=-1,a=s[t],c=s[t+1];a<c;)r(n,a++,e[++o]);else for(let o=-1,a=s[t],c=s[t+1];a<c;)r(n,a++,e.get(++o))},Ta=(i,t,e)=>{const n=i.children[0],s=i.valueOffsets,r=bt.getVisitFn(n);let{[t]:o,[t+1]:a}=s;const c=e instanceof Map?e.entries():Object.entries(e);for(const u of c)if(r(n,o,u),++o>=a)break},Ba=(i,t)=>(e,n,s,r)=>n&&e(n,i,t[r]),Ea=(i,t)=>(e,n,s,r)=>n&&e(n,i,t.get(r)),Na=(i,t)=>(e,n,s,r)=>n&&e(n,i,t.get(s.name)),Da=(i,t)=>(e,n,s,r)=>n&&e(n,i,t[s.name]),Ra=(i,t,e)=>{const n=i.type.children.map(r=>bt.getVisitFn(r.type)),s=e instanceof Map?Na(t,e):e instanceof R?Ea(t,e):Array.isArray(e)?Ba(t,e):Da(t,e);i.type.children.forEach((r,o)=>s(n[o],i.children[o],r,o))},La=(i,t,e)=>{i.type.mode===ut.Dense?lr(i,t,e):ur(i,t,e)},lr=(i,t,e)=>{const n=i.type.typeIdToChildIndex[i.typeIds[t]],s=i.children[n];bt.visit(s,i.valueOffsets[t],e)},ur=(i,t,e)=>{const n=i.type.typeIdToChildIndex[i.typeIds[t]],s=i.children[n];bt.visit(s,t,e)},Ma=(i,t,e)=>{var n;(n=i.dictionary)===null||n===void 0||n.set(i.values[t],e)},Ua=(i,t,e)=>{i.type.unit===Gt.DAY_TIME?dr(i,t,e):hr(i,t,e)},dr=({values:i},t,e)=>{i.set(e.subarray(0,2),2*t)},hr=({values:i},t,e)=>{i[t]=e[0]*12+e[1]%12},ka=(i,t,e)=>{const{stride:n}=i,s=i.children[0],r=bt.getVisitFn(s);if(Array.isArray(e))for(let o=-1,a=t*n;++o<n;)r(s,a+o,e[o]);else for(let o=-1,a=t*n;++o<n;)r(s,a+o,e.get(o))};w.prototype.visitBool=S(_a);w.prototype.visitInt=S(zt);w.prototype.visitInt8=S(zt);w.prototype.visitInt16=S(zt);w.prototype.visitInt32=S(zt);w.prototype.visitInt64=S(zt);w.prototype.visitUint8=S(zt);w.prototype.visitUint16=S(zt);w.prototype.visitUint32=S(zt);w.prototype.visitUint64=S(zt);w.prototype.visitFloat=S(ba);w.prototype.visitFloat16=S(Zs);w.prototype.visitFloat32=S(wn);w.prototype.visitFloat64=S(wn);w.prototype.visitUtf8=S(va);w.prototype.visitBinary=S(wa);w.prototype.visitFixedSizeBinary=S(ga);w.prototype.visitDate=S(Ia);w.prototype.visitDateDay=S(Xs);w.prototype.visitDateMillisecond=S(tr);w.prototype.visitTimestamp=S(Sa);w.prototype.visitTimestampSecond=S(er);w.prototype.visitTimestampMillisecond=S(ir);w.prototype.visitTimestampMicrosecond=S(nr);w.prototype.visitTimestampNanosecond=S(sr);w.prototype.visitTime=S(Aa);w.prototype.visitTimeSecond=S(rr);w.prototype.visitTimeMillisecond=S(or);w.prototype.visitTimeMicrosecond=S(ar);w.prototype.visitTimeNanosecond=S(cr);w.prototype.visitDecimal=S(Fa);w.prototype.visitList=S(Oa);w.prototype.visitStruct=S(Ra);w.prototype.visitUnion=S(La);w.prototype.visitDenseUnion=S(lr);w.prototype.visitSparseUnion=S(ur);w.prototype.visitDictionary=S(Ma);w.prototype.visitInterval=S(Ua);w.prototype.visitIntervalDayTime=S(dr);w.prototype.visitIntervalYearMonth=S(hr);w.prototype.visitFixedSizeList=S(ka);w.prototype.visitMap=S(Ta);const bt=new w,gt=Symbol.for("parent"),Ie=Symbol.for("rowIndex");class vn{constructor(t,e){return this[gt]=t,this[Ie]=e,new Proxy(this,new Ca)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[Ie],e=this[gt],n=e.type.children,s={};for(let r=-1,o=n.length;++r<o;)s[n[r].name]=rt.visit(e.children[r],t);return s}toString(){return`{${[...this].map(([t,e])=>`${Ce(t)}: ${Ce(e)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new xa(this[gt],this[Ie])}}class xa{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,rt.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(vn.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[gt]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Ie]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class Ca{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[gt].type.children.map(e=>e.name)}has(t,e){return t[gt].type.children.findIndex(n=>n.name===e)!==-1}getOwnPropertyDescriptor(t,e){if(t[gt].type.children.findIndex(n=>n.name===e)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[gt].type.children.findIndex(s=>s.name===e);if(n!==-1){const s=rt.visit(t[gt].children[n],t[Ie]);return Reflect.set(t,e,s),s}}set(t,e,n){const s=t[gt].type.children.findIndex(r=>r.name===e);return s!==-1?(bt.visit(t[gt].children[s],t[Ie],n),Reflect.set(t,e,n)):Reflect.has(t,e)?Reflect.set(t,e,n):!1}}class m extends T{}function v(i){return(t,e)=>t.getValid(e)?i(t,e):null}const Pa=(i,t)=>864e5*i[t],In=(i,t)=>4294967296*i[t+1]+(i[t]>>>0),ja=(i,t)=>4294967296*(i[t+1]/1e3)+(i[t]>>>0)/1e3,Va=(i,t)=>4294967296*(i[t+1]/1e6)+(i[t]>>>0)/1e6,fr=i=>new Date(i),za=(i,t)=>fr(Pa(i,t)),$a=(i,t)=>fr(In(i,t)),Ya=(i,t)=>null,pr=(i,t,e)=>{const{[e]:n,[e+1]:s}=t;return n!=null&&s!=null?i.subarray(n,s):null},Wa=({offset:i,values:t},e)=>{const n=i+e;return(t[n>>3]&1<<n%8)!==0},yr=({values:i},t)=>za(i,t),mr=({values:i},t)=>$a(i,t*2),Xt=({stride:i,values:t},e)=>t[i*e],Ga=({stride:i,values:t},e)=>Qs(t[i*e]),_r=({values:i},t)=>i[t],Ha=({stride:i,values:t},e)=>t.subarray(i*e,i*(e+1)),Ja=({values:i,valueOffsets:t},e)=>pr(i,t,e),Ka=({values:i,valueOffsets:t},e)=>{const n=pr(i,t,e);return n!==null?Xi(n):null},Qa=({values:i},t)=>i[t],qa=({type:i,values:t},e)=>i.precision!==K.HALF?t[e]:Qs(t[e]),Za=(i,t)=>i.type.unit===Vt.DAY?yr(i,t):mr(i,t),br=({values:i},t)=>1e3*In(i,t*2),gr=({values:i},t)=>In(i,t*2),wr=({values:i},t)=>ja(i,t*2),vr=({values:i},t)=>Va(i,t*2),Xa=(i,t)=>{switch(i.type.unit){case N.SECOND:return br(i,t);case N.MILLISECOND:return gr(i,t);case N.MICROSECOND:return wr(i,t);case N.NANOSECOND:return vr(i,t)}},Ir=({values:i},t)=>i[t],Sr=({values:i},t)=>i[t],Ar=({values:i},t)=>i[t],Fr=({values:i},t)=>i[t],tc=(i,t)=>{switch(i.type.unit){case N.SECOND:return Ir(i,t);case N.MILLISECOND:return Sr(i,t);case N.MICROSECOND:return Ar(i,t);case N.NANOSECOND:return Fr(i,t)}},ec=({values:i,stride:t},e)=>bn.decimal(i.subarray(t*e,t*(e+1))),ic=(i,t)=>{const{valueOffsets:e,stride:n}=i,{[t*n]:s}=e,{[t*n+1]:r}=e,a=i.children[0].slice(s,r-s);return new R([a])},nc=(i,t)=>{const{valueOffsets:e}=i,{[t]:n}=e,{[t+1]:s}=e,r=i.children[0];return new Sn(r.slice(n,s-n))},sc=(i,t)=>new vn(i,t),rc=(i,t)=>i.type.mode===ut.Dense?Or(i,t):Tr(i,t),Or=(i,t)=>{const e=i.type.typeIdToChildIndex[i.typeIds[t]],n=i.children[e];return rt.visit(n,i.valueOffsets[t])},Tr=(i,t)=>{const e=i.type.typeIdToChildIndex[i.typeIds[t]],n=i.children[e];return rt.visit(n,t)},oc=(i,t)=>{var e;return(e=i.dictionary)===null||e===void 0?void 0:e.get(i.values[t])},ac=(i,t)=>i.type.unit===Gt.DAY_TIME?Br(i,t):Er(i,t),Br=({values:i},t)=>i.subarray(2*t,2*(t+1)),Er=({values:i},t)=>{const e=i[t],n=new Int32Array(2);return n[0]=Math.trunc(e/12),n[1]=Math.trunc(e%12),n},cc=(i,t)=>{const{stride:e}=i,s=i.children[0].slice(t*e,e);return new R([s])};m.prototype.visitNull=v(Ya);m.prototype.visitBool=v(Wa);m.prototype.visitInt=v(Qa);m.prototype.visitInt8=v(Xt);m.prototype.visitInt16=v(Xt);m.prototype.visitInt32=v(Xt);m.prototype.visitInt64=v(_r);m.prototype.visitUint8=v(Xt);m.prototype.visitUint16=v(Xt);m.prototype.visitUint32=v(Xt);m.prototype.visitUint64=v(_r);m.prototype.visitFloat=v(qa);m.prototype.visitFloat16=v(Ga);m.prototype.visitFloat32=v(Xt);m.prototype.visitFloat64=v(Xt);m.prototype.visitUtf8=v(Ka);m.prototype.visitBinary=v(Ja);m.prototype.visitFixedSizeBinary=v(Ha);m.prototype.visitDate=v(Za);m.prototype.visitDateDay=v(yr);m.prototype.visitDateMillisecond=v(mr);m.prototype.visitTimestamp=v(Xa);m.prototype.visitTimestampSecond=v(br);m.prototype.visitTimestampMillisecond=v(gr);m.prototype.visitTimestampMicrosecond=v(wr);m.prototype.visitTimestampNanosecond=v(vr);m.prototype.visitTime=v(tc);m.prototype.visitTimeSecond=v(Ir);m.prototype.visitTimeMillisecond=v(Sr);m.prototype.visitTimeMicrosecond=v(Ar);m.prototype.visitTimeNanosecond=v(Fr);m.prototype.visitDecimal=v(ec);m.prototype.visitList=v(ic);m.prototype.visitStruct=v(sc);m.prototype.visitUnion=v(rc);m.prototype.visitDenseUnion=v(Or);m.prototype.visitSparseUnion=v(Tr);m.prototype.visitDictionary=v(oc);m.prototype.visitInterval=v(ac);m.prototype.visitIntervalDayTime=v(Br);m.prototype.visitIntervalYearMonth=v(Er);m.prototype.visitFixedSizeList=v(cc);m.prototype.visitMap=v(nc);const rt=new m,St=Symbol.for("keys"),Se=Symbol.for("vals");class Sn{constructor(t){return this[St]=new R([t.children[0]]).memoize(),this[Se]=t.children[1],new Proxy(this,new uc)}[Symbol.iterator](){return new lc(this[St],this[Se])}get size(){return this[St].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[St],e=this[Se],n={};for(let s=-1,r=t.length;++s<r;)n[t.get(s)]=rt.visit(e,s);return n}toString(){return`{${[...this].map(([t,e])=>`${Ce(t)}: ${Ce(e)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class lc{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),rt.visit(this.vals,t)]})}}class uc{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[St].toArray().map(String)}has(t,e){return t[St].includes(e)}getOwnPropertyDescriptor(t,e){if(t[St].indexOf(e)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[St].indexOf(e);if(n!==-1){const s=rt.visit(Reflect.get(t,Se),n);return Reflect.set(t,e,s),s}}set(t,e,n){const s=t[St].indexOf(e);return s!==-1?(bt.visit(Reflect.get(t,Se),s,n),Reflect.set(t,e,n)):Reflect.has(t,e)?Reflect.set(t,e,n):!1}}Object.defineProperties(Sn.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[St]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Se]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let qn;function Nr(i,t,e,n){const{length:s=0}=i;let r=typeof t!="number"?0:t,o=typeof e!="number"?s:e;return r<0&&(r=(r%s+s)%s),o<0&&(o=(o%s+s)%s),o<r&&(qn=r,r=o,o=qn),o>s&&(o=s),n?n(i,r,o):[r,o]}const Zn=i=>i!==i;function Re(i){if(typeof i!=="object"||i===null)return Zn(i)?Zn:e=>e===i;if(i instanceof Date){const e=i.valueOf();return n=>n instanceof Date?n.valueOf()===e:!1}return ArrayBuffer.isView(i)?e=>e?Ho(i,e):!1:i instanceof Map?hc(i):Array.isArray(i)?dc(i):i instanceof R?fc(i):pc(i,!0)}function dc(i){const t=[];for(let e=-1,n=i.length;++e<n;)t[e]=Re(i[e]);return Pi(t)}function hc(i){let t=-1;const e=[];for(const n of i.values())e[++t]=Re(n);return Pi(e)}function fc(i){const t=[];for(let e=-1,n=i.length;++e<n;)t[e]=Re(i.get(e));return Pi(t)}function pc(i,t=!1){const e=Object.keys(i);if(!t&&e.length===0)return()=>!1;const n=[];for(let s=-1,r=e.length;++s<r;)n[s]=Re(i[e[s]]);return Pi(n,e)}function Pi(i,t){return e=>{if(!e||typeof e!="object")return!1;switch(e.constructor){case Array:return yc(i,e);case Map:return Xn(i,e,e.keys());case Sn:case vn:case Object:case void 0:return Xn(i,e,t||Object.keys(e))}return e instanceof R?mc(i,e):!1}}function yc(i,t){const e=i.length;if(t.length!==e)return!1;for(let n=-1;++n<e;)if(!i[n](t[n]))return!1;return!0}function mc(i,t){const e=i.length;if(t.length!==e)return!1;for(let n=-1;++n<e;)if(!i[n](t.get(n)))return!1;return!0}function Xn(i,t,e){const n=e[Symbol.iterator](),s=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),r=t instanceof Map?t.values():Object.values(t)[Symbol.iterator]();let o=0;const a=i.length;let c=r.next(),u=n.next(),d=s.next();for(;o<a&&!u.done&&!d.done&&!c.done&&!(u.value!==d.value||!i[o](c.value));++o,u=n.next(),d=s.next(),c=r.next());return o===a&&u.done&&d.done&&c.done?!0:(n.return&&n.return(),s.return&&s.return(),r.return&&r.return(),!1)}function Dr(i,t,e,n){return(e&1<<n)!==0}function _c(i,t,e,n){return(e&1<<n)>>n}function An(i,t,e){const n=e.byteLength+7&-8;if(i>0||e.byteLength<n){const s=new Uint8Array(n);return s.set(i%8===0?e.subarray(i>>3):bi(new Fn(e,i,t,null,Dr)).subarray(0,n)),s}return e}function bi(i){const t=[];let e=0,n=0,s=0;for(const o of i)o&&(s|=1<<n),++n===8&&(t[e++]=s,s=n=0);(e===0||n>0)&&(t[e++]=s);const r=new Uint8Array(t.length+7&-8);return r.set(t),r}class Fn{constructor(t,e,n,s,r){this.bytes=t,this.length=n,this.context=s,this.get=r,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function sn(i,t,e){if(e-t<=0)return 0;if(e-t<8){let r=0;for(const o of new Fn(i,t,e-t,i,_c))r+=o;return r}const n=e>>3<<3,s=t+(t%8===0?0:8-t%8);return sn(i,t,s)+sn(i,n,e)+bc(i,s>>3,n-s>>3)}function bc(i,t,e){let n=0,s=Math.trunc(t);const r=new DataView(i.buffer,i.byteOffset,i.byteLength),o=e===void 0?i.byteLength:s+e;for(;o-s>=4;)n+=Hi(r.getUint32(s)),s+=4;for(;o-s>=2;)n+=Hi(r.getUint16(s)),s+=2;for(;o-s>=1;)n+=Hi(r.getUint8(s)),s+=1;return n}function Hi(i){let t=Math.trunc(i);return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}const gc=-1;class C{constructor(t,e,n,s,r,o=[],a){this.type=t,this.children=o,this.dictionary=a,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(s||0,-1));let c;r instanceof C?(this.stride=r.stride,this.values=r.values,this.typeIds=r.typeIds,this.nullBitmap=r.nullBitmap,this.valueOffsets=r.valueOffsets):(this.stride=kt(t),r&&((c=r[0])&&(this.valueOffsets=c),(c=r[1])&&(this.values=c),(c=r[2])&&(this.nullBitmap=c),(c=r[3])&&(this.typeIds=c))),this.nullable=this._nullCount!==0&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0;const{valueOffsets:e,values:n,nullBitmap:s,typeIds:r}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),s&&(t+=s.byteLength),r&&(t+=r.byteLength),this.children.reduce((o,a)=>o+a.byteLength,t)}get nullCount(){let t=this._nullCount,e;return t<=gc&&(e=this.nullBitmap)&&(this._nullCount=t=this.length-sn(e,this.offset,this.offset+this.length)),t}getValid(t){if(this.nullable&&this.nullCount>0){const e=this.offset+t;return(this.nullBitmap[e>>3]&1<<e%8)!==0}return!0}setValid(t,e){if(!this.nullable)return e;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){const{nullBitmap:c}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:c,_nullCount:0})}const{nullBitmap:n,offset:s}=this,r=s+t>>3,o=(s+t)%8,a=n[r]>>o&1;return e?a===0&&(n[r]|=1<<o,this._nullCount=this.nullCount+1):a===1&&(n[r]&=~(1<<o),this._nullCount=this.nullCount-1),e}clone(t=this.type,e=this.offset,n=this.length,s=this._nullCount,r=this,o=this.children){return new C(t,e,n,s,r,o,this.dictionary)}slice(t,e){const{stride:n,typeId:s,children:r}=this,o=+(this._nullCount===0)-1,a=s===16?n:1,c=this._sliceBuffers(t,e,n,s);return this.clone(this.type,this.offset+t,e,o,c,r.length===0||this.valueOffsets?r:this._sliceChildren(r,a*t,a*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===l.Null)return this.clone(this.type,0,t,0);const{length:e,nullCount:n}=this,s=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);s[e>>3]=(1<<e-(e&-8))-1,n>0&&s.set(An(this.offset,e,this.nullBitmap),0);const r=this.buffers;return r[Ut.VALIDITY]=s,this.clone(this.type,0,t,n+(t-e),r)}_sliceBuffers(t,e,n,s){let r;const{buffers:o}=this;return(r=o[Ut.TYPE])&&(o[Ut.TYPE]=r.subarray(t,t+e)),(r=o[Ut.OFFSET])&&(o[Ut.OFFSET]=r.subarray(t,t+e+1))||(r=o[Ut.DATA])&&(o[Ut.DATA]=s===6?r:r.subarray(n*t,n*(t+e))),o}_sliceChildren(t,e,n){return t.map(s=>s.slice(e,n))}}C.prototype.children=Object.freeze([]);class ke extends T{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{["type"]:e,["offset"]:n=0,["length"]:s=0}=t;return new C(e,n,s,0)}visitBool(t){const{["type"]:e,["offset"]:n=0}=t,s=E(t.nullBitmap),r=U(e.ArrayType,t.data),{["length"]:o=r.length>>3,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new C(e,n,o,a,[void 0,r,s])}visitInt(t){const{["type"]:e,["offset"]:n=0}=t,s=E(t.nullBitmap),r=U(e.ArrayType,t.data),{["length"]:o=r.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new C(e,n,o,a,[void 0,r,s])}visitFloat(t){const{["type"]:e,["offset"]:n=0}=t,s=E(t.nullBitmap),r=U(e.ArrayType,t.data),{["length"]:o=r.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new C(e,n,o,a,[void 0,r,s])}visitUtf8(t){const{["type"]:e,["offset"]:n=0}=t,s=E(t.data),r=E(t.nullBitmap),o=Le(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new C(e,n,a,c,[o,s,r])}visitBinary(t){const{["type"]:e,["offset"]:n=0}=t,s=E(t.data),r=E(t.nullBitmap),o=Le(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new C(e,n,a,c,[o,s,r])}visitFixedSizeBinary(t){const{["type"]:e,["offset"]:n=0}=t,s=E(t.nullBitmap),r=U(e.ArrayType,t.data),{["length"]:o=r.length/kt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new C(e,n,o,a,[void 0,r,s])}visitDate(t){const{["type"]:e,["offset"]:n=0}=t,s=E(t.nullBitmap),r=U(e.ArrayType,t.data),{["length"]:o=r.length/kt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new C(e,n,o,a,[void 0,r,s])}visitTimestamp(t){const{["type"]:e,["offset"]:n=0}=t,s=E(t.nullBitmap),r=U(e.ArrayType,t.data),{["length"]:o=r.length/kt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new C(e,n,o,a,[void 0,r,s])}visitTime(t){const{["type"]:e,["offset"]:n=0}=t,s=E(t.nullBitmap),r=U(e.ArrayType,t.data),{["length"]:o=r.length/kt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new C(e,n,o,a,[void 0,r,s])}visitDecimal(t){const{["type"]:e,["offset"]:n=0}=t,s=E(t.nullBitmap),r=U(e.ArrayType,t.data),{["length"]:o=r.length/kt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new C(e,n,o,a,[void 0,r,s])}visitList(t){const{["type"]:e,["offset"]:n=0,["child"]:s}=t,r=E(t.nullBitmap),o=Le(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new C(e,n,a,c,[o,void 0,r],[s])}visitStruct(t){const{["type"]:e,["offset"]:n=0,["children"]:s=[]}=t,r=E(t.nullBitmap),{length:o=s.reduce((c,{length:u})=>Math.max(c,u),0),nullCount:a=t.nullBitmap?-1:0}=t;return new C(e,n,o,a,[void 0,void 0,r],s)}visitUnion(t){const{["type"]:e,["offset"]:n=0,["children"]:s=[]}=t,r=E(t.nullBitmap),o=U(e.ArrayType,t.typeIds),{["length"]:a=o.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;if(y.isSparseUnion(e))return new C(e,n,a,c,[void 0,void 0,r,o],s);const u=Le(t.valueOffsets);return new C(e,n,a,c,[u,void 0,r,o],s)}visitDictionary(t){const{["type"]:e,["offset"]:n=0}=t,s=E(t.nullBitmap),r=U(e.indices.ArrayType,t.data),{["dictionary"]:o=new R([new ke().visit({type:e.dictionary})])}=t,{["length"]:a=r.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new C(e,n,a,c,[void 0,r,s],[],o)}visitInterval(t){const{["type"]:e,["offset"]:n=0}=t,s=E(t.nullBitmap),r=U(e.ArrayType,t.data),{["length"]:o=r.length/kt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new C(e,n,o,a,[void 0,r,s])}visitFixedSizeList(t){const{["type"]:e,["offset"]:n=0,["child"]:s=new ke().visit({type:e.valueType})}=t,r=E(t.nullBitmap),{["length"]:o=s.length/kt(e),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new C(e,n,o,a,[void 0,void 0,r],[s])}visitMap(t){const{["type"]:e,["offset"]:n=0,["child"]:s=new ke().visit({type:e.childType})}=t,r=E(t.nullBitmap),o=Le(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new C(e,n,a,c,[o,void 0,r],[s])}}function O(i){return new ke().visit(i)}class ts{constructor(t=0,e){this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function Rr(i){return i.reduce((t,e)=>t+e.nullCount,0)}function Lr(i){return i.reduce((t,e,n)=>(t[n+1]=t[n]+e.length,t),new Uint32Array(i.length+1))}function Mr(i,t,e,n){const s=[];for(let r=-1,o=i.length;++r<o;){const a=i[r],c=t[r],{length:u}=a;if(c>=n)break;if(e>=c+u)continue;if(c>=e&&c+u<=n){s.push(a);continue}const d=Math.max(0,e-c),h=Math.min(n-c,u);s.push(a.slice(d,h-d))}return s.length===0&&s.push(i[0].slice(0,0)),s}function On(i,t,e,n){let s=0,r=0,o=t.length-1;do{if(s>=o-1)return e<t[o]?n(i,s,e-t[s]):null;r=s+Math.trunc((o-s)*.5),e<t[r]?o=r:s=r}while(s<o)}function Tn(i,t){return i.getValid(t)}function Ae(i){function t(e,n,s){return i(e[n],s)}return function(e){const n=this.data;return On(n,this._offsets,e,t)}}function Ur(i){let t;function e(n,s,r){return i(n[s],r,t)}return function(n,s){const r=this.data;t=s;const o=On(r,this._offsets,n,e);return t=void 0,o}}function kr(i){let t;function e(n,s,r){let o=r,a=0,c=0;for(let u=s-1,d=n.length;++u<d;){const h=n[u];if(~(a=i(h,t,o)))return c+a;o=0,c+=h.length}return-1}return function(n,s){t=n;const r=this.data,o=typeof s!="number"?e(r,0,0):On(r,this._offsets,s,e);return t=void 0,o}}class _ extends T{}function wc(i,t){return t===null&&i.length>0?0:-1}function vc(i,t){const{nullBitmap:e}=i;if(!e||i.nullCount<=0)return-1;let n=0;for(const s of new Fn(e,i.offset+(t||0),i.length,e,Dr)){if(!s)return n;++n}return-1}function F(i,t,e){if(t===void 0)return-1;if(t===null)return vc(i,e);const n=rt.getVisitFn(i),s=Re(t);for(let r=(e||0)-1,o=i.length;++r<o;)if(s(n(i,r)))return r;return-1}function xr(i,t,e){const n=rt.getVisitFn(i),s=Re(t);for(let r=(e||0)-1,o=i.length;++r<o;)if(s(n(i,r)))return r;return-1}_.prototype.visitNull=wc;_.prototype.visitBool=F;_.prototype.visitInt=F;_.prototype.visitInt8=F;_.prototype.visitInt16=F;_.prototype.visitInt32=F;_.prototype.visitInt64=F;_.prototype.visitUint8=F;_.prototype.visitUint16=F;_.prototype.visitUint32=F;_.prototype.visitUint64=F;_.prototype.visitFloat=F;_.prototype.visitFloat16=F;_.prototype.visitFloat32=F;_.prototype.visitFloat64=F;_.prototype.visitUtf8=F;_.prototype.visitBinary=F;_.prototype.visitFixedSizeBinary=F;_.prototype.visitDate=F;_.prototype.visitDateDay=F;_.prototype.visitDateMillisecond=F;_.prototype.visitTimestamp=F;_.prototype.visitTimestampSecond=F;_.prototype.visitTimestampMillisecond=F;_.prototype.visitTimestampMicrosecond=F;_.prototype.visitTimestampNanosecond=F;_.prototype.visitTime=F;_.prototype.visitTimeSecond=F;_.prototype.visitTimeMillisecond=F;_.prototype.visitTimeMicrosecond=F;_.prototype.visitTimeNanosecond=F;_.prototype.visitDecimal=F;_.prototype.visitList=F;_.prototype.visitStruct=F;_.prototype.visitUnion=F;_.prototype.visitDenseUnion=xr;_.prototype.visitSparseUnion=xr;_.prototype.visitDictionary=F;_.prototype.visitInterval=F;_.prototype.visitIntervalDayTime=F;_.prototype.visitIntervalYearMonth=F;_.prototype.visitFixedSizeList=F;_.prototype.visitMap=F;const gi=new _;class b extends T{}function I(i){const{type:t}=i;if(i.nullCount===0&&i.stride===1&&(t.typeId===l.Timestamp||t instanceof tt&&t.bitWidth!==64||t instanceof Ve&&t.bitWidth!==64||t instanceof Jt&&t.precision!==K.HALF))return new ts(i.data.length,n=>{const s=i.data[n];return s.values.subarray(0,s.length)[Symbol.iterator]()});let e=0;return new ts(i.data.length,n=>{const r=i.data[n].length,o=i.slice(e,e+r);return e+=r,new Ic(o)})}class Ic{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}b.prototype.visitNull=I;b.prototype.visitBool=I;b.prototype.visitInt=I;b.prototype.visitInt8=I;b.prototype.visitInt16=I;b.prototype.visitInt32=I;b.prototype.visitInt64=I;b.prototype.visitUint8=I;b.prototype.visitUint16=I;b.prototype.visitUint32=I;b.prototype.visitUint64=I;b.prototype.visitFloat=I;b.prototype.visitFloat16=I;b.prototype.visitFloat32=I;b.prototype.visitFloat64=I;b.prototype.visitUtf8=I;b.prototype.visitBinary=I;b.prototype.visitFixedSizeBinary=I;b.prototype.visitDate=I;b.prototype.visitDateDay=I;b.prototype.visitDateMillisecond=I;b.prototype.visitTimestamp=I;b.prototype.visitTimestampSecond=I;b.prototype.visitTimestampMillisecond=I;b.prototype.visitTimestampMicrosecond=I;b.prototype.visitTimestampNanosecond=I;b.prototype.visitTime=I;b.prototype.visitTimeSecond=I;b.prototype.visitTimeMillisecond=I;b.prototype.visitTimeMicrosecond=I;b.prototype.visitTimeNanosecond=I;b.prototype.visitDecimal=I;b.prototype.visitList=I;b.prototype.visitStruct=I;b.prototype.visitUnion=I;b.prototype.visitDenseUnion=I;b.prototype.visitSparseUnion=I;b.prototype.visitDictionary=I;b.prototype.visitInterval=I;b.prototype.visitIntervalDayTime=I;b.prototype.visitIntervalYearMonth=I;b.prototype.visitFixedSizeList=I;b.prototype.visitMap=I;const Bn=new b,rn=(i,t)=>i+t;class te extends T{visitNull(t,e){return 0}visitInt(t,e){return t.type.bitWidth/8}visitFloat(t,e){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,e){return 1/8}visitDecimal(t,e){return 16}visitDate(t,e){return(t.type.unit+1)*4}visitTime(t,e){return t.type.bitWidth/8}visitTimestamp(t,e){return t.type.unit===N.SECOND?4:8}visitInterval(t,e){return(t.type.unit+1)*4}visitStruct(t,e){return this.visitMany(t.children,t.children.map(()=>e)).reduce(rn,0)}visitFixedSizeBinary(t,e){return t.type.byteWidth}visitMap(t,e){return this.visitMany(t.children,t.children.map(()=>e)).reduce(rn,0)}visitDictionary(t,e){var n;return t.type.indices.bitWidth/8+(((n=t.dictionary)===null||n===void 0?void 0:n.getByteLength(t.values[e]))||0)}}const Sc=({valueOffsets:i},t)=>8+(i[t+1]-i[t]),Ac=({valueOffsets:i},t)=>8+(i[t+1]-i[t]),Fc=({valueOffsets:i,stride:t,children:e},n)=>{const s=e[0],{[n*t]:r}=i,{[n*t+1]:o}=i,a=Kt.getVisitFn(s.type),c=s.slice(r,o-r);let u=8;for(let d=-1,h=o-r;++d<h;)u+=a(c,d);return u},Oc=({stride:i,children:t},e)=>{const n=t[0],s=n.slice(e*i,i),r=Kt.getVisitFn(n.type);let o=0;for(let a=-1,c=s.length;++a<c;)o+=r(s,a);return o},Tc=(i,t)=>i.type.mode===ut.Dense?Cr(i,t):Pr(i,t),Cr=({type:i,children:t,typeIds:e,valueOffsets:n},s)=>{const r=i.typeIdToChildIndex[e[s]];return 8+Kt.visit(t[r],n[s])},Pr=({children:i},t)=>4+Kt.visitMany(i,i.map(()=>t)).reduce(rn,0);te.prototype.visitUtf8=Sc;te.prototype.visitBinary=Ac;te.prototype.visitList=Fc;te.prototype.visitFixedSizeList=Oc;te.prototype.visitUnion=Tc;te.prototype.visitDenseUnion=Cr;te.prototype.visitSparseUnion=Pr;const Kt=new te;var jr;const Vr={},zr={};class R{constructor(t){var e,n,s;const r=t[0]instanceof R?t.flatMap(a=>a.data):t;if(r.some(a=>!(a instanceof C)))throw new TypeError("Vector constructor expects an Array of Data instances.");const o=(e=r[0])===null||e===void 0?void 0:e.type;switch(r.length){case 0:this._offsets=[0];break;case 1:{const{get:a,set:c,indexOf:u,byteLength:d}=Vr[o.typeId],h=r[0];this.isValid=f=>Tn(h,f),this.get=f=>a(h,f),this.set=(f,x)=>c(h,f,x),this.indexOf=f=>u(h,f),this.getByteLength=f=>d(h,f),this._offsets=[0,h.length];break}default:Object.setPrototypeOf(this,zr[o.typeId]),this._offsets=Lr(r);break}this.data=r,this.type=o,this.stride=kt(o),this.numChildren=(s=(n=o.children)===null||n===void 0?void 0:n.length)!==null&&s!==void 0?s:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return this._byteLength===-1&&(this._byteLength=this.data.reduce((t,e)=>t+e.byteLength,0)),this._byteLength}get nullCount(){return this._nullCount===-1&&(this._nullCount=Rr(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${l[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>0}getByteLength(t){return 0}[Symbol.iterator](){return Bn.visit(this)}concat(...t){return new R(this.data.concat(t.flatMap(e=>e.data).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new R(Nr(this,t,e,({data:n,_offsets:s},r,o)=>Mr(n,s,r,o)))}toJSON(){return[...this]}toArray(){const{type:t,data:e,length:n,stride:s,ArrayType:r}=this;switch(t.typeId){case l.Int:case l.Float:case l.Decimal:case l.Time:case l.Timestamp:switch(e.length){case 0:return new r;case 1:return e[0].values.subarray(0,n*s);default:return e.reduce((o,{values:a})=>(o.array.set(a,o.offset),o.offset+=a.length,o),{array:new r(n*s),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt((e=this.type.children)===null||e===void 0?void 0:e.findIndex(n=>n.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new R(this.data.map(({children:e})=>e[t])):null}get isMemoized(){return y.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(y.isDictionary(this.type)){const t=new wi(this.data[0].dictionary),e=this.data.map(n=>{const s=n.clone();return s.dictionary=t,s});return new R(e)}return new wi(this)}unmemoize(){if(y.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),e=this.data.map(n=>{const s=n.clone();return s.dictionary=t,s});return new R(e)}return this}}jr=Symbol.toStringTag;R[jr]=(i=>{i.type=y.prototype,i.data=[],i.length=0,i.stride=1,i.numChildren=0,i._nullCount=-1,i._byteLength=-1,i._offsets=new Uint32Array([0]),i[Symbol.isConcatSpreadable]=!0;const t=Object.keys(l).map(e=>l[e]).filter(e=>typeof e=="number"&&e!==l.NONE);for(const e of t){const n=rt.getVisitFnByTypeId(e),s=bt.getVisitFnByTypeId(e),r=gi.getVisitFnByTypeId(e),o=Kt.getVisitFnByTypeId(e);Vr[e]={get:n,set:s,indexOf:r,byteLength:o},zr[e]=Object.create(i,{isValid:{value:Ae(Tn)},get:{value:Ae(rt.getVisitFnByTypeId(e))},set:{value:Ur(bt.getVisitFnByTypeId(e))},indexOf:{value:kr(gi.getVisitFnByTypeId(e))},getByteLength:{value:Ae(Kt.getVisitFnByTypeId(e))}})}return"Vector"})(R.prototype);class wi extends R{constructor(t){super(t.data);const e=this.get,n=this.set,s=this.slice,r=new Array(this.length);Object.defineProperty(this,"get",{value(o){const a=r[o];if(a!==void 0)return a;const c=e.call(this,o);return r[o]=c,c}}),Object.defineProperty(this,"set",{value(o,a){n.call(this,o,a),r[o]=a}}),Object.defineProperty(this,"slice",{value:(o,a)=>new wi(s.call(this,o,a))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new R(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class on{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,e,n,s){return t.prep(8,24),t.writeInt64(s),t.pad(4),t.writeInt32(n),t.writeInt64(e),t.offset()}}const Ji=2,At=4,xt=4,k=4,Yt=new Int32Array(2),es=new Float32Array(Yt.buffer),is=new Float64Array(Yt.buffer),Ze=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;class mt{constructor(t,e){this.low=t|0,this.high=e|0}static create(t,e){return t==0&&e==0?mt.ZERO:new mt(t,e)}toFloat64(){return(this.low>>>0)+this.high*4294967296}equals(t){return this.low==t.low&&this.high==t.high}}mt.ZERO=new mt(0,0);var an;(function(i){i[i.UTF8_BYTES=1]="UTF8_BYTES",i[i.UTF16_STRING=2]="UTF16_STRING"})(an||(an={}));class Qt{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new Qt(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new mt(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new mt(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return Yt[0]=this.readInt32(t),es[0]}readFloat64(t){return Yt[Ze?0:1]=this.readInt32(t),Yt[Ze?1:0]=this.readInt32(t+4),is[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){es[0]=e,this.writeInt32(t,Yt[0])}writeFloat64(t,e){is[0]=e,this.writeInt32(t,Yt[Ze?0:1]),this.writeInt32(t+4,Yt[Ze?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+At+xt)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<xt;e++)t+=String.fromCharCode(this.readInt8(this.position_+At+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);let s="",r=0;if(t+=At,e===an.UTF8_BYTES)return this.bytes_.subarray(t,t+n);for(;r<n;){let o;const a=this.readUint8(t+r++);if(a<192)o=a;else{const c=this.readUint8(t+r++);if(a<224)o=(a&31)<<6|c&63;else{const u=this.readUint8(t+r++);if(a<240)o=(a&15)<<12|(c&63)<<6|u&63;else{const d=this.readUint8(t+r++);o=(a&7)<<18|(c&63)<<12|(u&63)<<6|d&63}}}o<65536?s+=String.fromCharCode(o):(o-=65536,s+=String.fromCharCode((o>>10)+55296,(o&(1<<10)-1)+56320))}return s}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+At}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=xt)throw new Error("FlatBuffers: file identifier must be length "+xt);for(let e=0;e<xt;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+At+e))return!1;return!0}createLong(t,e){return mt.create(t,e)}createScalarList(t,e){const n=[];for(let s=0;s<e;++s)t(s)!==null&&n.push(t(s));return n}createObjList(t,e){const n=[];for(let s=0;s<e;++s){const r=t(s);r!==null&&n.push(r.unpack())}return n}}class ji{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null;let e;t?e=t:e=1024,this.bb=Qt.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const n=~(this.bb.capacity()-this.space+e)+1&t-1;for(;this.space<n+t+e;){const s=this.bb.capacity();this.bb=ji.growByteBuffer(this.bb),this.space+=this.bb.capacity()-s}this.pad(n)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){(this.force_defaults||!e.equals(n))&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=e<<1,s=Qt.allocate(n);return s.setPosition(n-e),s.bytes().set(t.bytes(),n-e),s}addOffset(t){this.prep(At,0),this.writeInt32(this.offset()-t+At)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&this.vtable[e]==0;e--);const n=e+1;for(;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);const s=2;this.addInt16(t-this.object_start);const r=(n+s)*Ji;this.addInt16(r);let o=0;const a=this.space;t:for(e=0;e<this.vtables.length;e++){const c=this.bb.capacity()-this.vtables[e];if(r==this.bb.readInt16(c)){for(let u=Ji;u<r;u+=Ji)if(this.bb.readInt16(a+u)!=this.bb.readInt16(c+u))continue t;o=this.vtables[e];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){const s=n?k:0;if(e){const r=e;if(this.prep(this.minalign,At+xt+s),r.length!=xt)throw new Error("FlatBuffers: file identifier must be length "+xt);for(let o=xt-1;o>=0;o--)this.writeInt8(r.charCodeAt(o))}this.prep(this.minalign,At+s),this.addOffset(t),s&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const n=this.bb.capacity()-t,s=n-this.bb.readInt32(n);if(!(this.bb.readInt16(s+e)!=0))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(At,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let n=0;for(;n<t.length;){let s;const r=t.charCodeAt(n++);if(r<55296||r>=56320)s=r;else{const o=t.charCodeAt(n++);s=(r<<10)+o+(65536-(55296<<10)-56320)}s<128?e.push(s):(s<2048?e.push(s>>6&31|192):(s<65536?e.push(s>>12&15|224):e.push(s>>18&7|240,s>>12&63|128),e.push(s>>6&63|128)),e.push(s&63|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let n=0,s=this.space,r=this.bb.bytes();n<e.length;n++)r[s++]=e[n];return this.endVector()}createLong(t,e){return mt.create(t,e)}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n];if(s!==null)e.push(this.createObjectOffset(s));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}}class W{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsKeyValue(t,e){return(e||new W).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,e){return t.setPosition(t.position()+k),(e||new W).__init(t.readInt32(t.position())+t.position(),t)}key(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}value(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,e){t.addFieldOffset(0,e,0)}static addValue(t,e){t.addFieldOffset(1,e,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,e,n){return W.startKeyValue(t),W.addKey(t,e),W.addValue(t,n),W.endKeyValue(t)}}var Oe;(function(i){i[i.V1=0]="V1",i[i.V2=1]="V2",i[i.V3=2]="V3",i[i.V4=3]="V4",i[i.V5=4]="V5"})(Oe||(Oe={}));var Te;(function(i){i[i.Little=0]="Little",i[i.Big=1]="Big"})(Te||(Te={}));var vi;(function(i){i[i.DenseArray=0]="DenseArray"})(vi||(vi={}));class ct{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInt(t,e){return(e||new ct).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,e){return t.setPosition(t.position()+k),(e||new ct).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startInt(t){t.startObject(2)}static addBitWidth(t,e){t.addFieldInt32(0,e,0)}static addIsSigned(t,e){t.addFieldInt8(1,+e,0)}static endInt(t){return t.endObject()}static createInt(t,e,n){return ct.startInt(t),ct.addBitWidth(t,e),ct.addIsSigned(t,n),ct.endInt(t)}}class Ct{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryEncoding(t,e){return(e||new Ct).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,e){return t.setPosition(t.position()+k),(e||new Ct).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new ct).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isOrdered(){const t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}dictionaryKind(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):vi.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addIndexType(t,e){t.addFieldOffset(1,e,0)}static addIsOrdered(t,e){t.addFieldInt8(2,+e,0)}static addDictionaryKind(t,e){t.addFieldInt16(3,e,vi.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}}class se{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBinary(t,e){return(e||new se).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,e){return t.setPosition(t.position()+k),(e||new se).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return se.startBinary(t),se.endBinary(t)}}class re{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBool(t,e){return(e||new re).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,e){return t.setPosition(t.position()+k),(e||new re).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return re.startBool(t),re.endBool(t)}}var Ii;(function(i){i[i.DAY=0]="DAY",i[i.MILLISECOND=1]="MILLISECOND"})(Ii||(Ii={}));class Ft{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDate(t,e){return(e||new Ft).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,e){return t.setPosition(t.position()+k),(e||new Ft).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ii.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,Ii.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,e){return Ft.startDate(t),Ft.addUnit(t,e),Ft.endDate(t)}}class it{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDecimal(t,e){return(e||new it).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,e){return t.setPosition(t.position()+k),(e||new it).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,e){t.addFieldInt32(0,e,0)}static addScale(t,e){t.addFieldInt32(1,e,0)}static addBitWidth(t,e){t.addFieldInt32(2,e,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,e,n,s){return it.startDecimal(t),it.addPrecision(t,e),it.addScale(t,n),it.addBitWidth(t,s),it.endDecimal(t)}}var Be;(function(i){i[i.SECOND=0]="SECOND",i[i.MILLISECOND=1]="MILLISECOND",i[i.MICROSECOND=2]="MICROSECOND",i[i.NANOSECOND=3]="NANOSECOND"})(Be||(Be={}));class Ot{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeBinary(t,e){return(e||new Ot).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,e){return t.setPosition(t.position()+k),(e||new Ot).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,e){return Ot.startFixedSizeBinary(t),Ot.addByteWidth(t,e),Ot.endFixedSizeBinary(t)}}class Tt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeList(t,e){return(e||new Tt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,e){return t.setPosition(t.position()+k),(e||new Tt).__init(t.readInt32(t.position())+t.position(),t)}listSize(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,e){return Tt.startFixedSizeList(t),Tt.addListSize(t,e),Tt.endFixedSizeList(t)}}var Si;(function(i){i[i.HALF=0]="HALF",i[i.SINGLE=1]="SINGLE",i[i.DOUBLE=2]="DOUBLE"})(Si||(Si={}));class Bt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFloatingPoint(t,e){return(e||new Bt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,e){return t.setPosition(t.position()+k),(e||new Bt).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Si.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,e){t.addFieldInt16(0,e,Si.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,e){return Bt.startFloatingPoint(t),Bt.addPrecision(t,e),Bt.endFloatingPoint(t)}}var Ai;(function(i){i[i.YEAR_MONTH=0]="YEAR_MONTH",i[i.DAY_TIME=1]="DAY_TIME",i[i.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Ai||(Ai={}));class Et{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInterval(t,e){return(e||new Et).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,e){return t.setPosition(t.position()+k),(e||new Et).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ai.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,Ai.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,e){return Et.startInterval(t),Et.addUnit(t,e),Et.endInterval(t)}}class oe{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsList(t,e){return(e||new oe).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,e){return t.setPosition(t.position()+k),(e||new oe).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return oe.startList(t),oe.endList(t)}}class Nt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMap(t,e){return(e||new Nt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,e){return t.setPosition(t.position()+k),(e||new Nt).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){const t=this.bb.__offset(this.bb_pos,4);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startMap(t){t.startObject(1)}static addKeysSorted(t,e){t.addFieldInt8(0,+e,0)}static endMap(t){return t.endObject()}static createMap(t,e){return Nt.startMap(t),Nt.addKeysSorted(t,e),Nt.endMap(t)}}class ae{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsNull(t,e){return(e||new ae).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,e){return t.setPosition(t.position()+k),(e||new ae).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return ae.startNull(t),ae.endNull(t)}}class ce{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStruct_(t,e){return(e||new ce).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,e){return t.setPosition(t.position()+k),(e||new ce).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return ce.startStruct_(t),ce.endStruct_(t)}}class pt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTime(t,e){return(e||new pt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,e){return t.setPosition(t.position()+k),(e||new pt).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Be.MILLISECOND}bitWidth(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,Be.MILLISECOND)}static addBitWidth(t,e){t.addFieldInt32(1,e,32)}static endTime(t){return t.endObject()}static createTime(t,e,n){return pt.startTime(t),pt.addUnit(t,e),pt.addBitWidth(t,n),pt.endTime(t)}}class yt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTimestamp(t,e){return(e||new yt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,e){return t.setPosition(t.position()+k),(e||new yt).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Be.SECOND}timezone(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,Be.SECOND)}static addTimezone(t,e){t.addFieldOffset(1,e,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,e,n){return yt.startTimestamp(t),yt.addUnit(t,e),yt.addTimezone(t,n),yt.endTimestamp(t)}}var Fi;(function(i){i[i.Sparse=0]="Sparse",i[i.Dense=1]="Dense"})(Fi||(Fi={}));class nt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUnion(t,e){return(e||new nt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,e){return t.setPosition(t.position()+k),(e||new nt).__init(t.readInt32(t.position())+t.position(),t)}mode(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Fi.Sparse}typeIds(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+t*4):0}typeIdsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,e){t.addFieldInt16(0,e,Fi.Sparse)}static addTypeIds(t,e){t.addFieldOffset(1,e,0)}static createTypeIdsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startTypeIdsVector(t,e){t.startVector(4,e,4)}static endUnion(t){return t.endObject()}static createUnion(t,e,n){return nt.startUnion(t),nt.addMode(t,e),nt.addTypeIds(t,n),nt.endUnion(t)}}class le{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUtf8(t,e){return(e||new le).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,e){return t.setPosition(t.position()+k),(e||new le).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return le.startUtf8(t),le.endUtf8(t)}}var j;(function(i){i[i.NONE=0]="NONE",i[i.Null=1]="Null",i[i.Int=2]="Int",i[i.FloatingPoint=3]="FloatingPoint",i[i.Binary=4]="Binary",i[i.Utf8=5]="Utf8",i[i.Bool=6]="Bool",i[i.Decimal=7]="Decimal",i[i.Date=8]="Date",i[i.Time=9]="Time",i[i.Timestamp=10]="Timestamp",i[i.Interval=11]="Interval",i[i.List=12]="List",i[i.Struct_=13]="Struct_",i[i.Union=14]="Union",i[i.FixedSizeBinary=15]="FixedSizeBinary",i[i.FixedSizeList=16]="FixedSizeList",i[i.Map=17]="Map",i[i.Duration=18]="Duration",i[i.LargeBinary=19]="LargeBinary",i[i.LargeUtf8=20]="LargeUtf8",i[i.LargeList=21]="LargeList"})(j||(j={}));class Q{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsField(t,e){return(e||new Q).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,e){return t.setPosition(t.position()+k),(e||new Q).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}nullable(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}typeType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):j.NONE}type(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__union(t,this.bb_pos+e):null}dictionary(t){const e=this.bb.__offset(this.bb_pos,12);return e?(t||new Ct).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}children(t,e){const n=this.bb.__offset(this.bb_pos,14);return n?(e||new Q).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}childrenLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,16);return n?(e||new W).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,e){t.addFieldOffset(0,e,0)}static addNullable(t,e){t.addFieldInt8(1,+e,0)}static addTypeType(t,e){t.addFieldInt8(2,e,j.NONE)}static addType(t,e){t.addFieldOffset(3,e,0)}static addDictionary(t,e){t.addFieldOffset(4,e,0)}static addChildren(t,e){t.addFieldOffset(5,e,0)}static createChildrenVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startChildrenVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(6,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endField(t){return t.endObject()}}class ${constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSchema(t,e){return(e||new $).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,e){return t.setPosition(t.position()+k),(e||new $).__init(t.readInt32(t.position())+t.position(),t)}endianness(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Te.Little}fields(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new Q).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}fieldsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new W).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+t*8):this.bb.createLong(0,0)}featuresLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,e){t.addFieldInt16(0,e,Te.Little)}static addFields(t,e){t.addFieldOffset(1,e,0)}static createFieldsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startFieldsVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(2,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static addFeatures(t,e){t.addFieldOffset(3,e,0)}static createFeaturesVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startFeaturesVector(t,e){t.startVector(8,e,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,e){t.finish(e)}static finishSizePrefixedSchemaBuffer(t,e){t.finish(e,void 0,!0)}static createSchema(t,e,n,s,r){return $.startSchema(t),$.addEndianness(t,e),$.addFields(t,n),$.addCustomMetadata(t,s),$.addFeatures(t,r),$.endSchema(t)}}class at{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFooter(t,e){return(e||new at).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,e){return t.setPosition(t.position()+k),(e||new at).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Oe.V1}schema(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new $).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dictionaries(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new on).__init(this.bb.__vector(this.bb_pos+n)+t*24,this.bb):null}dictionariesLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,e){const n=this.bb.__offset(this.bb_pos,10);return n?(e||new on).__init(this.bb.__vector(this.bb_pos+n)+t*24,this.bb):null}recordBatchesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new W).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,Oe.V1)}static addSchema(t,e){t.addFieldOffset(1,e,0)}static addDictionaries(t,e){t.addFieldOffset(2,e,0)}static startDictionariesVector(t,e){t.startVector(24,e,8)}static addRecordBatches(t,e){t.addFieldOffset(3,e,0)}static startRecordBatchesVector(t,e){t.startVector(24,e,8)}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,e){t.finish(e)}static finishSizePrefixedFooterBuffer(t,e){t.finish(e,void 0,!0)}}class L{constructor(t=[],e,n){this.fields=t||[],this.metadata=e||new Map,n||(n=cn(t)),this.dictionaries=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(t=>t.name)}toString(){return`Schema<{ ${this.fields.map((t,e)=>`${e}: ${t}`).join(", ")} }>`}select(t){const e=new Set(t),n=this.fields.filter(s=>e.has(s.name));return new L(n,this.metadata)}selectAt(t){const e=t.map(n=>this.fields[n]).filter(Boolean);return new L(e,this.metadata)}assign(...t){const e=t[0]instanceof L?t[0]:Array.isArray(t[0])?new L(t[0]):new L(t),n=[...this.fields],s=Xe(Xe(new Map,this.metadata),e.metadata),r=e.fields.filter(a=>{const c=n.findIndex(u=>u.name===a.name);return~c?(n[c]=a.clone({metadata:Xe(Xe(new Map,n[c].metadata),a.metadata)}))&&!1:!0}),o=cn(r,new Map);return new L([...n,...r],s,new Map([...this.dictionaries,...o]))}}L.prototype.fields=null;L.prototype.metadata=null;L.prototype.dictionaries=null;class P{constructor(t,e,n=!1,s){this.name=t,this.type=e,this.nullable=n,this.metadata=s||new Map}static new(...t){let[e,n,s,r]=t;return t[0]&&typeof t[0]=="object"&&({name:e}=t[0],n===void 0&&(n=t[0].type),s===void 0&&(s=t[0].nullable),r===void 0&&(r=t[0].metadata)),new P(`${e}`,n,s,r)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[e,n,s,r]=t;return!t[0]||typeof t[0]!="object"?[e=this.name,n=this.type,s=this.nullable,r=this.metadata]=t:{name:e=this.name,type:n=this.type,nullable:s=this.nullable,metadata:r=this.metadata}=t[0],P.new(e,n,s,r)}}P.prototype.type=null;P.prototype.name=null;P.prototype.nullable=null;P.prototype.metadata=null;function Xe(i,t){return new Map([...i||new Map,...t||new Map])}function cn(i,t=new Map){for(let e=-1,n=i.length;++e<n;){const r=i[e].type;if(y.isDictionary(r)){if(!t.has(r.id))t.set(r.id,r.dictionary);else if(t.get(r.id)!==r.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}r.children&&r.children.length>0&&cn(r.children,t)}return t}var ns=mt,Bc=ji,Ec=Qt;class ze{constructor(t,e=lt.V4,n,s){this.schema=t,this.version=e,n&&(this._recordBatches=n),s&&(this._dictionaryBatches=s)}static decode(t){t=new Ec(E(t));const e=at.getRootAsFooter(t),n=L.decode(e.schema());return new Nc(n,e)}static encode(t){const e=new Bc,n=L.encode(e,t.schema);at.startRecordBatchesVector(e,t.numRecordBatches);for(const o of[...t.recordBatches()].slice().reverse())qt.encode(e,o);const s=e.endVector();at.startDictionariesVector(e,t.numDictionaries);for(const o of[...t.dictionaryBatches()].slice().reverse())qt.encode(e,o);const r=e.endVector();return at.startFooter(e),at.addSchema(e,n),at.addVersion(e,lt.V4),at.addRecordBatches(e,s),at.addDictionaries(e,r),at.finishFooterBuffer(e,at.endFooter(e)),e.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,e=-1,n=this.numRecordBatches;++e<n;)(t=this.getRecordBatch(e))&&(yield t)}*dictionaryBatches(){for(let t,e=-1,n=this.numDictionaries;++e<n;)(t=this.getDictionaryBatch(e))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class Nc extends ze{constructor(t,e){super(t,e.version());this._footer=e}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const e=this._footer.recordBatches(t);if(e)return qt.decode(e)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const e=this._footer.dictionaries(t);if(e)return qt.decode(e)}return null}}class qt{constructor(t,e,n){this.metaDataLength=t,this.offset=typeof n=="number"?n:n.low,this.bodyLength=typeof e=="number"?e:e.low}static decode(t){return new qt(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,e){const{metaDataLength:n}=e,s=new ns(e.offset,0),r=new ns(e.bodyLength,0);return on.createBlock(t,s,n,r)}}const V=Object.freeze({done:!0,value:void 0});class ss{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class En{tee(){return this._getDOMStream().tee()}pipe(t,e){return this._getNodeStream().pipe(t,e)}pipeTo(t,e){return this._getDOMStream().pipeTo(t,e)}pipeThrough(t,e){return this._getDOMStream().pipeThrough(t,e)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class Dc extends En{constructor(){super();this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}cancel(t){return p(this,void 0,void 0,function*(){yield this.return(t)})}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(V);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return ht.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return ht.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return p(this,void 0,void 0,function*(){return yield this.abort(t),V})}return(t){return p(this,void 0,void 0,function*(){return yield this.close(),V})}read(t){return p(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return p(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((e,n)=>{this.resolvers.push({resolve:e,reject:n})}):Promise.resolve(V)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class ni extends Dc{write(t){if((t=E(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?Xi(this.toUint8Array(!0)):this.toUint8Array(!1).then(Xi)}toUint8Array(t=!1){return t?Lt(this._values)[0]:(()=>p(this,void 0,void 0,function*(){var e,n;const s=[];let r=0;try{for(var o=ue(this),a;a=yield o.next(),!a.done;){const c=a.value;s.push(c),r+=c.byteLength}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=o.return)&&(yield n.call(o))}finally{if(e)throw e.error}}return Lt(s,r)[0]}))()}}class Oi{constructor(t){t&&(this.source=new Rc(ht.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class Ee{constructor(t){t instanceof Ee?this.source=t.source:t instanceof ni?this.source=new ie(ht.fromAsyncIterable(t)):Ts(t)?this.source=new ie(ht.fromNodeStream(t)):yn(t)?this.source=new ie(ht.fromDOMStream(t)):Os(t)?this.source=new ie(ht.fromDOMStream(t.body)):We(t)?this.source=new ie(ht.fromIterable(t)):he(t)?this.source=new ie(ht.fromAsyncIterable(t)):De(t)&&(this.source=new ie(ht.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class Rc{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,e="read"){return this.source.next({cmd:e,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||V)}return(t){return Object.create(this.source.return&&this.source.return(t)||V)}}class ie{constructor(t){this.source=t,this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}cancel(t){return p(this,void 0,void 0,function*(){yield this.return(t)})}get closed(){return this._closedPromise}read(t){return p(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return p(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(t,e="read"){return p(this,void 0,void 0,function*(){return yield this.source.next({cmd:e,size:t})})}throw(t){return p(this,void 0,void 0,function*(){const e=this.source.throw&&(yield this.source.throw(t))||V;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)})}return(t){return p(this,void 0,void 0,function*(){const e=this.source.return&&(yield this.source.return(t))||V;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)})}}class rs extends Oi{constructor(t,e){super();this.position=0,this.buffer=E(t),this.size=typeof e=="undefined"?this.buffer.byteLength:e}readInt32(t){const{buffer:e,byteOffset:n}=this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:e,size:n,position:s}=this;return e&&s<n?(typeof t!="number"&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(n,s+Math.min(n-s,t)),e.subarray(s,this.position)):null}readAt(t,e){const n=this.buffer,s=Math.min(this.size,t+e);return n?n.subarray(t,s):new Uint8Array(e)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class Ti extends Ee{constructor(t,e){super();this.position=0,this._handle=t,typeof e=="number"?this.size=e:this._pending=(()=>p(this,void 0,void 0,function*(){this.size=(yield t.stat()).size,delete this._pending}))()}readInt32(t){return p(this,void 0,void 0,function*(){const{buffer:e,byteOffset:n}=yield this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)})}seek(t){return p(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size})}read(t){return p(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:e,size:n,position:s}=this;if(e&&s<n){typeof t!="number"&&(t=Number.POSITIVE_INFINITY);let r=s,o=0,a=0;const c=Math.min(n,r+Math.min(n-r,t)),u=new Uint8Array(Math.max(0,(this.position=c)-r));for(;(r+=a)<c&&(o+=a)<u.byteLength;)({bytesRead:a}=yield e.read(u,o,u.byteLength-o,r));return u}return null})}readAt(t,e){return p(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:n,size:s}=this;if(n&&t+e<s){const r=Math.min(s,t+e),o=new Uint8Array(r-t);return(yield n.read(o,0,e,t)).buffer}return new Uint8Array(e)})}close(){return p(this,void 0,void 0,function*(){const t=this._handle;this._handle=null,t&&(yield t.close())})}throw(t){return p(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}return(t){return p(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}}const Lc=1<<16;function ge(i){return i<0&&(i=4294967295+i+1),`0x${i.toString(16)}`}const Ne=8,Nn=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class $r{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const e=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),n=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]);let s=e[3]*n[3];this.buffer[0]=s&65535;let r=s>>>16;return s=e[2]*n[3],r+=s,s=e[3]*n[2]>>>0,r+=s,this.buffer[0]+=r<<16,this.buffer[1]=r>>>0<s?Lc:0,this.buffer[1]+=r>>>16,this.buffer[1]+=e[1]*n[3]+e[2]*n[2]+e[3]*n[1],this.buffer[1]+=e[0]*n[3]+e[1]*n[2]+e[2]*n[1]+e[3]*n[0]<<16,this}_plus(t){const e=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],e<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=e}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${ge(this.buffer[1])} ${ge(this.buffer[0])}`}}class M extends $r{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,e=new Uint32Array(2)){return M.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return M.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const n=t.length,s=new M(e);for(let r=0;r<n;){const o=Ne<n-r?Ne:n-r,a=new M(new Uint32Array([Number.parseInt(t.slice(r,r+o),10),0])),c=new M(new Uint32Array([Nn[o],0]));s.times(c),s.plus(a),r+=o}return s}static convertArray(t){const e=new Uint32Array(t.length*2);for(let n=-1,s=t.length;++n<s;)M.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new M(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new M(new Uint32Array(t.buffer)).plus(e)}}class et extends $r{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const e=this.buffer[1]<<0,n=t.buffer[1]<<0;return e<n||e===n&&this.buffer[0]<t.buffer[0]}static from(t,e=new Uint32Array(2)){return et.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return et.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const n=t.startsWith("-"),s=t.length,r=new et(e);for(let o=n?1:0;o<s;){const a=Ne<s-o?Ne:s-o,c=new et(new Uint32Array([Number.parseInt(t.slice(o,o+a),10),0])),u=new et(new Uint32Array([Nn[a],0]));r.times(u),r.plus(c),o+=a}return n?r.negate():r}static convertArray(t){const e=new Uint32Array(t.length*2);for(let n=-1,s=t.length;++n<s;)et.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new et(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new et(new Uint32Array(t.buffer)).plus(e)}}class It{constructor(t){this.buffer=t}high(){return new et(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new et(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){const e=new M(new Uint32Array([this.buffer[3],0])),n=new M(new Uint32Array([this.buffer[2],0])),s=new M(new Uint32Array([this.buffer[1],0])),r=new M(new Uint32Array([this.buffer[0],0])),o=new M(new Uint32Array([t.buffer[3],0])),a=new M(new Uint32Array([t.buffer[2],0])),c=new M(new Uint32Array([t.buffer[1],0])),u=new M(new Uint32Array([t.buffer[0],0]));let d=M.multiply(r,u);this.buffer[0]=d.low();const h=new M(new Uint32Array([d.high(),0]));return d=M.multiply(s,u),h.plus(d),d=M.multiply(r,c),h.plus(d),this.buffer[1]=h.low(),this.buffer[3]=h.lessThan(d)?1:0,this.buffer[2]=h.high(),new M(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(M.multiply(n,u)).plus(M.multiply(s,c)).plus(M.multiply(r,a)),this.buffer[3]+=M.multiply(e,u).plus(M.multiply(n,c)).plus(M.multiply(s,a)).plus(M.multiply(r,o)).low(),this}plus(t){const e=new Uint32Array(4);return e[3]=this.buffer[3]+t.buffer[3]>>>0,e[2]=this.buffer[2]+t.buffer[2]>>>0,e[1]=this.buffer[1]+t.buffer[1]>>>0,e[0]=this.buffer[0]+t.buffer[0]>>>0,e[0]<this.buffer[0]>>>0&&++e[1],e[1]<this.buffer[1]>>>0&&++e[2],e[2]<this.buffer[2]>>>0&&++e[3],this.buffer[3]=e[3],this.buffer[2]=e[2],this.buffer[1]=e[1],this.buffer[0]=e[0],this}hex(){return`${ge(this.buffer[3])} ${ge(this.buffer[2])} ${ge(this.buffer[1])} ${ge(this.buffer[0])}`}static multiply(t,e){return new It(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new It(new Uint32Array(t.buffer)).plus(e)}static from(t,e=new Uint32Array(4)){return It.fromString(typeof t=="string"?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(4)){return It.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(4)){const n=t.startsWith("-"),s=t.length,r=new It(e);for(let o=n?1:0;o<s;){const a=Ne<s-o?Ne:s-o,c=new It(new Uint32Array([Number.parseInt(t.slice(o,o+a),10),0,0,0])),u=new It(new Uint32Array([Nn[a],0,0,0]));r.times(u),r.plus(c),o+=a}return n?r.negate():r}static convertArray(t){const e=new Uint32Array(t.length*4);for(let n=-1,s=t.length;++n<s;)It.from(t[n],new Uint32Array(e.buffer,e.byteOffset+4*4*n,4));return e}}class Yr extends T{constructor(t,e,n,s){super();this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=e,this.buffers=n,this.dictionaries=s}visit(t){return super.visit(t instanceof P?t.type:t)}visitNull(t,{length:e}=this.nextFieldNode()){return O({type:t,length:e})}visitBool(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitInt(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFloat(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitUtf8(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDate(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTimestamp(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTime(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDecimal(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitList(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===ut.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFixedSizeList(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),child:this.visit(t.children[0])})}visitMap(t,{length:e,nullCount:n}=this.nextFieldNode()){return O({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,e,n=this.nextBufferRange()){return e>0&&this.readData(t,n)||new Uint8Array(0)}readOffsets(t,e){return this.readData(t,e)}readTypeIds(t,e){return this.readData(t,e)}readData(t,{length:e,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+e)}readDictionary(t){return this.dictionaries.get(t.id)}}class Mc extends Yr{constructor(t,e,n,s){super(new Uint8Array(0),e,n,s);this.sources=t}readNullBitmap(t,e,{offset:n}=this.nextBufferRange()){return e<=0?new Uint8Array(0):bi(this.sources[n])}readOffsets(t,{offset:e}=this.nextBufferRange()){return U(Uint8Array,U(Int32Array,this.sources[e]))}readTypeIds(t,{offset:e}=this.nextBufferRange()){return U(Uint8Array,U(t.ArrayType,this.sources[e]))}readData(t,{offset:e}=this.nextBufferRange()){const{sources:n}=this;return y.isTimestamp(t)||(y.isInt(t)||y.isTime(t))&&t.bitWidth===64||y.isDate(t)&&t.unit===Vt.MILLISECOND?U(Uint8Array,et.convertArray(n[e])):y.isDecimal(t)?U(Uint8Array,It.convertArray(n[e])):y.isBinary(t)||y.isFixedSizeBinary(t)?Uc(n[e]):y.isBool(t)?bi(n[e]):y.isUtf8(t)?pn(n[e].join("")):U(Uint8Array,U(t.ArrayType,n[e].map(s=>+s)))}}function Uc(i){const t=i.join(""),e=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2)e[n>>1]=Number.parseInt(t.slice(n,n+2),16);return e}class g extends T{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every((n,s)=>this.compareFields(n,e[s]))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}}function ot(i,t){return t instanceof i.constructor}function Ge(i,t){return i===t||ot(i,t)}function $t(i,t){return i===t||ot(i,t)&&i.bitWidth===t.bitWidth&&i.isSigned===t.isSigned}function Vi(i,t){return i===t||ot(i,t)&&i.precision===t.precision}function kc(i,t){return i===t||ot(i,t)&&i.byteWidth===t.byteWidth}function Dn(i,t){return i===t||ot(i,t)&&i.unit===t.unit}function He(i,t){return i===t||ot(i,t)&&i.unit===t.unit&&i.timezone===t.timezone}function Je(i,t){return i===t||ot(i,t)&&i.unit===t.unit&&i.bitWidth===t.bitWidth}function xc(i,t){return i===t||ot(i,t)&&i.children.length===t.children.length&&Zt.compareManyFields(i.children,t.children)}function Cc(i,t){return i===t||ot(i,t)&&i.children.length===t.children.length&&Zt.compareManyFields(i.children,t.children)}function Rn(i,t){return i===t||ot(i,t)&&i.mode===t.mode&&i.typeIds.every((e,n)=>e===t.typeIds[n])&&Zt.compareManyFields(i.children,t.children)}function Pc(i,t){return i===t||ot(i,t)&&i.id===t.id&&i.isOrdered===t.isOrdered&&Zt.visit(i.indices,t.indices)&&Zt.visit(i.dictionary,t.dictionary)}function Ln(i,t){return i===t||ot(i,t)&&i.unit===t.unit}function jc(i,t){return i===t||ot(i,t)&&i.listSize===t.listSize&&i.children.length===t.children.length&&Zt.compareManyFields(i.children,t.children)}function Vc(i,t){return i===t||ot(i,t)&&i.keysSorted===t.keysSorted&&i.children.length===t.children.length&&Zt.compareManyFields(i.children,t.children)}g.prototype.visitNull=Ge;g.prototype.visitBool=Ge;g.prototype.visitInt=$t;g.prototype.visitInt8=$t;g.prototype.visitInt16=$t;g.prototype.visitInt32=$t;g.prototype.visitInt64=$t;g.prototype.visitUint8=$t;g.prototype.visitUint16=$t;g.prototype.visitUint32=$t;g.prototype.visitUint64=$t;g.prototype.visitFloat=Vi;g.prototype.visitFloat16=Vi;g.prototype.visitFloat32=Vi;g.prototype.visitFloat64=Vi;g.prototype.visitUtf8=Ge;g.prototype.visitBinary=Ge;g.prototype.visitFixedSizeBinary=kc;g.prototype.visitDate=Dn;g.prototype.visitDateDay=Dn;g.prototype.visitDateMillisecond=Dn;g.prototype.visitTimestamp=He;g.prototype.visitTimestampSecond=He;g.prototype.visitTimestampMillisecond=He;g.prototype.visitTimestampMicrosecond=He;g.prototype.visitTimestampNanosecond=He;g.prototype.visitTime=Je;g.prototype.visitTimeSecond=Je;g.prototype.visitTimeMillisecond=Je;g.prototype.visitTimeMicrosecond=Je;g.prototype.visitTimeNanosecond=Je;g.prototype.visitDecimal=Ge;g.prototype.visitList=xc;g.prototype.visitStruct=Cc;g.prototype.visitUnion=Rn;g.prototype.visitDenseUnion=Rn;g.prototype.visitSparseUnion=Rn;g.prototype.visitDictionary=Pc;g.prototype.visitInterval=Ln;g.prototype.visitIntervalDayTime=Ln;g.prototype.visitIntervalYearMonth=Ln;g.prototype.visitFixedSizeList=jc;g.prototype.visitMap=Vc;const Zt=new g;function ln(i,t){return Zt.compareSchemas(i,t)}function Ki(i,t){return zc(i,t.map(e=>e.data.concat()))}function zc(i,t){const e=[...i.fields],n=[],s={numBatches:t.reduce((h,f)=>Math.max(h,f.length),0)};let r=0,o=0,a=-1;const c=t.length;let u,d=[];for(;s.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,a=-1;++a<c;)d[a]=u=t[a].shift(),o=Math.min(o,u?u.length:o);Number.isFinite(o)&&(d=$c(e,o,d,t,s),o>0&&(n[r++]=O({type:new Z(e),length:o,nullCount:0,children:d.slice()})))}return[i=i.assign(e),n.map(h=>new G(i,h))]}function $c(i,t,e,n,s){var r;const o=(t+63&-64)>>3;for(let a=-1,c=n.length;++a<c;){const u=e[a],d=u==null?void 0:u.length;if(d>=t)d===t?e[a]=u:(e[a]=u.slice(0,t),s.numBatches=Math.max(s.numBatches,n[a].unshift(u.slice(t,d-t))));else{const h=i[a];i[a]=h.clone({nullable:!0}),e[a]=(r=u==null?void 0:u._changeLengthAndBackfillNullBitmap(t))!==null&&r!==void 0?r:O({type:h.type,length:t,nullCount:t,nullBitmap:new Uint8Array(o)})}}return e}var Wr;class q{constructor(...t){var e,n;if(t.length===0)return this.batches=[],this.schema=new L([]),this._offsets=[0],this;let s,r;t[0]instanceof L&&(s=t.shift()),t[t.length-1]instanceof Uint32Array&&(r=t.pop());const o=c=>{if(c){if(c instanceof G)return[c];if(c instanceof q)return c.batches;if(c instanceof C){if(c.type instanceof Z)return[new G(new L(c.type.children),c)]}else{if(Array.isArray(c))return c.flatMap(u=>o(u));if(typeof c[Symbol.iterator]=="function")return[...c].flatMap(u=>o(u));if(typeof c=="object"){const u=Object.keys(c),d=u.map(x=>new R([c[x]])),h=new L(u.map((x,J)=>new P(String(x),d[J].type))),[,f]=Ki(h,d);return f.length===0?[new G(c)]:f}}}return[]},a=t.flatMap(c=>o(c));if(s=(n=s!=null?s:(e=a[0])===null||e===void 0?void 0:e.schema)!==null&&n!==void 0?n:new L([]),!(s instanceof L))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const c of a){if(!(c instanceof G))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!ln(s,c.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=s,this.batches=a,this._offsets=r!=null?r:Lr(this.data)}get data(){return this.batches.map(({data:t})=>t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((t,e)=>t+e.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=Rr(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}getByteLength(t){return 0}[Symbol.iterator](){return Bn.visit(new R(this.data))}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...t){const e=this.schema,n=this.data.concat(t.flatMap(({data:s})=>s));return new q(e,n.map(s=>new G(e,s)))}slice(t,e){const n=this.schema;[t,e]=Nr({length:this.numRows},t,e);const s=Mr(this.data,this._offsets,t,e);return new q(n,s.map(r=>new G(n,r)))}getChild(t){return this.getChildAt(this.schema.fields.findIndex(e=>e.name===t))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const e=this.data.map(n=>n.children[t]);if(e.length===0){const{type:n}=this.schema.fields[t],s=O({type:n,length:0,nullCount:0});e.push(s._changeLengthAndBackfillNullBitmap(this.numRows))}return new R(e)}return null}setChild(t,e){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(s=>s.name===t),e)}setChildAt(t,e){let n=this.schema,s=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new R([O({type:new Ht,length:this.numRows})]));const r=n.fields.slice(),o=r[t].clone({type:e.type}),a=this.schema.fields.map((c,u)=>this.getChildAt(u));[r[t],a[t]]=[o,e],[n,s]=Ki(n,a)}return new q(n,s)}select(t){const e=this.schema.fields.reduce((n,s,r)=>n.set(s.name,r),new Map);return this.selectAt(t.map(n=>e.get(n)).filter(n=>n>-1))}selectAt(t){const e=this.schema.selectAt(t),n=this.batches.map(s=>s.selectAt(t));return new q(e,n)}assign(t){const e=this.schema.fields,[n,s]=t.schema.fields.reduce((a,c,u)=>{const[d,h]=a,f=e.findIndex(x=>x.name===c.name);return~f?h[f]=u:d.push(u),a},[[],[]]),r=this.schema.assign(t.schema),o=[...e.map((a,c)=>[c,s[c]]).map(([a,c])=>c===void 0?this.getChildAt(a):t.getChildAt(c)),...n.map(a=>t.getChildAt(a))].filter(Boolean);return new q(...Ki(r,o))}}Wr=Symbol.toStringTag;q[Wr]=(i=>(i.schema=null,i.batches=[],i._offsets=new Uint32Array([0]),i._nullCount=-1,i[Symbol.isConcatSpreadable]=!0,i.isValid=Ae(Tn),i.get=Ae(rt.getVisitFn(l.Struct)),i.set=Ur(bt.getVisitFn(l.Struct)),i.indexOf=kr(gi.getVisitFn(l.Struct)),i.getByteLength=Ae(Kt.getVisitFn(l.Struct)),"Table"))(q.prototype);var Gr;class G{constructor(...t){switch(t.length){case 2:{if([this.schema]=t,!(this.schema instanceof L))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=O({nullCount:0,type:new Z(this.schema.fields),children:this.schema.fields.map(e=>O({type:e.type,nullCount:0}))})]=t,!(this.data instanceof C))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=os(this.schema,this.data.children);break}case 1:{const[e]=t,{fields:n,children:s,length:r}=Object.keys(e).reduce((c,u,d)=>(c.children[d]=e[u],c.length=Math.max(c.length,e[u].length),c.fields[d]=P.new({name:u,type:e[u].type,nullable:!0}),c),{length:0,fields:new Array,children:new Array}),o=new L(n),a=O({type:new Z(n),length:r,children:s,nullCount:0});[this.schema,this.data]=os(o,a.children,r);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=Hr(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return rt.visit(this.data,t)}set(t,e){return bt.visit(this.data,t,e)}indexOf(t,e){return gi.visit(this.data,t,e)}getByteLength(t){return Kt.visit(this.data,t)}[Symbol.iterator](){return Bn.visit(new R([this.data]))}toArray(){return[...this]}concat(...t){return new q(this.schema,[this,...t])}slice(t,e){const[n]=new R([this.data]).slice(t,e).data;return new G(this.schema,n)}getChild(t){var e;return this.getChildAt((e=this.schema.fields)===null||e===void 0?void 0:e.findIndex(n=>n.name===t))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new R([this.data.children[t]]):null}setChild(t,e){var n;return this.setChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(s=>s.name===t),e)}setChildAt(t,e){let n=this.schema,s=this.data;if(t>-1&&t<this.numCols){e||(e=new R([O({type:new Ht,length:this.numRows})]));const r=n.fields.slice(),o=s.children.slice(),a=r[t].clone({type:e.type});[r[t],o[t]]=[a,e.data[0]],n=new L(r,new Map(this.schema.metadata)),s=O({type:new Z(r),children:o})}return new G(n,s)}select(t){const e=this.schema.select(t),n=new Z(e.fields),s=[];for(const r of t){const o=this.schema.fields.findIndex(a=>a.name===r);~o&&(s[o]=this.data.children[o])}return new G(e,O({type:n,length:this.numRows,children:s}))}selectAt(t){const e=this.schema.selectAt(t),n=t.map(r=>this.data.children[r]).filter(Boolean),s=O({type:new Z(e.fields),length:this.numRows,children:n});return new G(e,s)}}Gr=Symbol.toStringTag;G[Gr]=(i=>(i._nullCount=-1,i[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(G.prototype);function os(i,t,e=t.reduce((n,s)=>Math.max(n,s.length),0)){var n;const s=[...i.fields],r=[...t],o=(e+63&-64)>>3;for(const[a,c]of i.fields.entries()){const u=t[a];(!u||u.length!==e)&&(s[a]=c.clone({nullable:!0}),r[a]=(n=u==null?void 0:u._changeLengthAndBackfillNullBitmap(e))!==null&&n!==void 0?n:O({type:c.type,length:e,nullCount:e,nullBitmap:new Uint8Array(o)}))}return[i.assign(s),O({type:new Z(s),length:e,children:r})]}function Hr(i,t,e=new Map){for(let n=-1,s=i.length;++n<s;){const o=i[n].type,a=t[n];if(y.isDictionary(o)){if(!e.has(o.id))a.dictionary&&e.set(o.id,a.dictionary);else if(e.get(o.id)!==a.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}o.children&&o.children.length>0&&Hr(o.children,a.children,e)}return e}class Mn extends G{constructor(t){const e=t.fields.map(s=>O({type:s.type})),n=O({type:new Z(t.fields),nullCount:0,children:e});super(t,n)}}var Bi;(function(i){i[i.BUFFER=0]="BUFFER"})(Bi||(Bi={}));var Ei;(function(i){i[i.LZ4_FRAME=0]="LZ4_FRAME",i[i.ZSTD=1]="ZSTD"})(Ei||(Ei={}));class Wt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBodyCompression(t,e){return(e||new Wt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,e){return t.setPosition(t.position()+k),(e||new Wt).__init(t.readInt32(t.position())+t.position(),t)}codec(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):Ei.LZ4_FRAME}method(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):Bi.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,e){t.addFieldInt8(0,e,Ei.LZ4_FRAME)}static addMethod(t,e){t.addFieldInt8(1,e,Bi.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,e,n){return Wt.startBodyCompression(t),Wt.addCodec(t,e),Wt.addMethod(t,n),Wt.endBodyCompression(t)}}class Jr{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}}class Kr{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}}class ft{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsRecordBatch(t,e){return(e||new ft).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,e){return t.setPosition(t.position()+k),(e||new ft).__init(t.readInt32(t.position())+t.position(),t)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new Kr).__init(this.bb.__vector(this.bb_pos+n)+t*16,this.bb):null}nodesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new Jr).__init(this.bb.__vector(this.bb_pos+n)+t*16,this.bb):null}buffersLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){const e=this.bb.__offset(this.bb_pos,10);return e?(t||new Wt).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addNodes(t,e){t.addFieldOffset(1,e,0)}static startNodesVector(t,e){t.startVector(16,e,8)}static addBuffers(t,e){t.addFieldOffset(2,e,0)}static startBuffersVector(t,e){t.startVector(16,e,8)}static addCompression(t,e){t.addFieldOffset(3,e,0)}static endRecordBatch(t){return t.endObject()}}class Pt{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryBatch(t,e){return(e||new Pt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,e){return t.setPosition(t.position()+k),(e||new Pt).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new ft).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isDelta(){const t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startDictionaryBatch(t){t.startObject(3)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addData(t,e){t.addFieldOffset(1,e,0)}static addIsDelta(t,e){t.addFieldInt8(2,+e,0)}static endDictionaryBatch(t){return t.endObject()}}var Ni;(function(i){i[i.NONE=0]="NONE",i[i.Schema=1]="Schema",i[i.DictionaryBatch=2]="DictionaryBatch",i[i.RecordBatch=3]="RecordBatch",i[i.Tensor=4]="Tensor",i[i.SparseTensor=5]="SparseTensor"})(Ni||(Ni={}));class H{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMessage(t,e){return(e||new H).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,e){return t.setPosition(t.position()+k),(e||new H).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Oe.V1}headerType(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):Ni.NONE}header(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(t,this.bb_pos+e):null}bodyLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new W).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,Oe.V1)}static addHeaderType(t,e){t.addFieldInt8(1,e,Ni.NONE)}static addHeader(t,e){t.addFieldOffset(2,e,0)}static addBodyLength(t,e){t.addFieldInt64(3,e,t.createLong(0,0))}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,e){t.finish(e)}static finishSizePrefixedMessageBuffer(t,e){t.finish(e,void 0,!0)}static createMessage(t,e,n,s,r,o){return H.startMessage(t),H.addVersion(t,e),H.addHeaderType(t,n),H.addHeader(t,s),H.addBodyLength(t,r),H.addCustomMetadata(t,o),H.endMessage(t)}}var Yc=mt;class Wc extends T{visit(t,e){return t==null||e==null?void 0:super.visit(t,e)}visitNull(t,e){return ae.startNull(e),ae.endNull(e)}visitInt(t,e){return ct.startInt(e),ct.addBitWidth(e,t.bitWidth),ct.addIsSigned(e,t.isSigned),ct.endInt(e)}visitFloat(t,e){return Bt.startFloatingPoint(e),Bt.addPrecision(e,t.precision),Bt.endFloatingPoint(e)}visitBinary(t,e){return se.startBinary(e),se.endBinary(e)}visitBool(t,e){return re.startBool(e),re.endBool(e)}visitUtf8(t,e){return le.startUtf8(e),le.endUtf8(e)}visitDecimal(t,e){return it.startDecimal(e),it.addScale(e,t.scale),it.addPrecision(e,t.precision),it.addBitWidth(e,t.bitWidth),it.endDecimal(e)}visitDate(t,e){return Ft.startDate(e),Ft.addUnit(e,t.unit),Ft.endDate(e)}visitTime(t,e){return pt.startTime(e),pt.addUnit(e,t.unit),pt.addBitWidth(e,t.bitWidth),pt.endTime(e)}visitTimestamp(t,e){const n=t.timezone&&e.createString(t.timezone)||void 0;return yt.startTimestamp(e),yt.addUnit(e,t.unit),n!==void 0&&yt.addTimezone(e,n),yt.endTimestamp(e)}visitInterval(t,e){return Et.startInterval(e),Et.addUnit(e,t.unit),Et.endInterval(e)}visitList(t,e){return oe.startList(e),oe.endList(e)}visitStruct(t,e){return ce.startStruct_(e),ce.endStruct_(e)}visitUnion(t,e){nt.startTypeIdsVector(e,t.typeIds.length);const n=nt.createTypeIdsVector(e,t.typeIds);return nt.startUnion(e),nt.addMode(e,t.mode),nt.addTypeIds(e,n),nt.endUnion(e)}visitDictionary(t,e){const n=this.visit(t.indices,e);return Ct.startDictionaryEncoding(e),Ct.addId(e,new Yc(t.id,0)),Ct.addIsOrdered(e,t.isOrdered),n!==void 0&&Ct.addIndexType(e,n),Ct.endDictionaryEncoding(e)}visitFixedSizeBinary(t,e){return Ot.startFixedSizeBinary(e),Ot.addByteWidth(e,t.byteWidth),Ot.endFixedSizeBinary(e)}visitFixedSizeList(t,e){return Tt.startFixedSizeList(e),Tt.addListSize(e,t.listSize),Tt.endFixedSizeList(e)}visitMap(t,e){return Nt.startMap(e),Nt.addKeysSorted(e,t.keysSorted),Nt.endMap(e)}}const Qi=new Wc;function Gc(i,t=new Map){return new L(Jc(i,t),si(i.customMetadata),t)}function Qr(i){return new dt(i.count,qr(i.columns),Zr(i.columns))}function Hc(i){return new Mt(Qr(i.data),i.id,i.isDelta)}function Jc(i,t){return(i.fields||[]).filter(Boolean).map(e=>P.fromJSON(e,t))}function as(i,t){return(i.children||[]).filter(Boolean).map(e=>P.fromJSON(e,t))}function qr(i){return(i||[]).reduce((t,e)=>[...t,new pe(e.count,Kc(e.VALIDITY)),...qr(e.children)],[])}function Zr(i,t=[]){for(let e=-1,n=(i||[]).length;++e<n;){const s=i[e];s.VALIDITY&&t.push(new Rt(t.length,s.VALIDITY.length)),s.TYPE&&t.push(new Rt(t.length,s.TYPE.length)),s.OFFSET&&t.push(new Rt(t.length,s.OFFSET.length)),s.DATA&&t.push(new Rt(t.length,s.DATA.length)),t=Zr(s.children,t)}return t}function Kc(i){return(i||[]).reduce((t,e)=>t+ +(e===0),0)}function Qc(i,t){let e,n,s,r,o,a;return!t||!(r=i.dictionary)?(o=ls(i,as(i,t)),s=new P(i.name,o,i.nullable,si(i.customMetadata))):t.has(e=r.id)?(n=(n=r.indexType)?cs(n):new je,a=new Fe(t.get(e),n,e,r.isOrdered),s=new P(i.name,a,i.nullable,si(i.customMetadata))):(n=(n=r.indexType)?cs(n):new je,t.set(e,o=ls(i,as(i,t))),a=new Fe(o,n,e,r.isOrdered),s=new P(i.name,a,i.nullable,si(i.customMetadata))),s||null}function si(i){return new Map(Object.entries(i||{}))}function cs(i){return new tt(i.isSigned,i.bitWidth)}function ls(i,t){const e=i.type.name;switch(e){case"NONE":return new Ht;case"null":return new Ht;case"binary":return new oi;case"utf8":return new ai;case"bool":return new ci;case"list":return new fi((t||[])[0]);case"struct":return new Z(t||[]);case"struct_":return new Z(t||[])}switch(e){case"int":{const n=i.type;return new tt(n.isSigned,n.bitWidth)}case"floatingpoint":{const n=i.type;return new Jt(K[n.precision])}case"decimal":{const n=i.type;return new li(n.scale,n.precision,n.bitWidth)}case"date":{const n=i.type;return new ui(Vt[n.unit])}case"time":{const n=i.type;return new Ve(N[n.unit],n.bitWidth)}case"timestamp":{const n=i.type;return new di(N[n.unit],n.timezone)}case"interval":{const n=i.type;return new hi(Gt[n.unit])}case"union":{const n=i.type;return new pi(ut[n.mode],n.typeIds||[],t||[])}case"fixedsizebinary":{const n=i.type;return new yi(n.byteWidth)}case"fixedsizelist":{const n=i.type;return new mi(n.listSize,(t||[])[0])}case"map":{const n=i.type;return new _i((t||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${e}"`)}var fe=mt,qc=ji,Zc=Qt;class X{constructor(t,e,n,s){this._version=e,this._headerType=n,this.body=new Uint8Array(0),s&&(this._createHeader=()=>s),this._bodyLength=typeof t=="number"?t:t.low}static fromJSON(t,e){const n=new X(0,lt.V4,e);return n._createHeader=Xc(t,e),n}static decode(t){t=new Zc(E(t));const e=H.getRootAsMessage(t),n=e.bodyLength(),s=e.version(),r=e.headerType(),o=new X(n,s,r);return o._createHeader=tl(e,r),o}static encode(t){const e=new qc;let n=-1;return t.isSchema()?n=L.encode(e,t.header()):t.isRecordBatch()?n=dt.encode(e,t.header()):t.isDictionaryBatch()&&(n=Mt.encode(e,t.header())),H.startMessage(e),H.addVersion(e,lt.V4),H.addHeader(e,n),H.addHeaderType(e,t.headerType),H.addBodyLength(e,new fe(t.bodyLength,0)),H.finishMessageBuffer(e,H.endMessage(e)),e.asUint8Array()}static from(t,e=0){if(t instanceof L)return new X(0,lt.V4,D.Schema,t);if(t instanceof dt)return new X(e,lt.V4,D.RecordBatch,t);if(t instanceof Mt)return new X(e,lt.V4,D.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===D.Schema}isRecordBatch(){return this.headerType===D.RecordBatch}isDictionaryBatch(){return this.headerType===D.DictionaryBatch}}class dt{constructor(t,e,n){this._nodes=e,this._buffers=n,this._length=typeof t=="number"?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}}class Mt{constructor(t,e,n=!1){this._data=t,this._isDelta=n,this._id=typeof e=="number"?e:e.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}}class Rt{constructor(t,e){this.offset=typeof t=="number"?t:t.low,this.length=typeof e=="number"?e:e.low}}class pe{constructor(t,e){this.length=typeof t=="number"?t:t.low,this.nullCount=typeof e=="number"?e:e.low}}function Xc(i,t){return()=>{switch(t){case D.Schema:return L.fromJSON(i);case D.RecordBatch:return dt.fromJSON(i);case D.DictionaryBatch:return Mt.fromJSON(i)}throw new Error(`Unrecognized Message type: { name: ${D[t]}, type: ${t} }`)}}function tl(i,t){return()=>{switch(t){case D.Schema:return L.decode(i.header(new $));case D.RecordBatch:return dt.decode(i.header(new ft),i.version());case D.DictionaryBatch:return Mt.decode(i.header(new Pt),i.version())}throw new Error(`Unrecognized Message type: { name: ${D[t]}, type: ${t} }`)}}P.encode=dl;P.decode=ll;P.fromJSON=Qc;L.encode=ul;L.decode=el;L.fromJSON=Gc;dt.encode=hl;dt.decode=il;dt.fromJSON=Qr;Mt.encode=fl;Mt.decode=nl;Mt.fromJSON=Hc;pe.encode=pl;pe.decode=rl;Rt.encode=yl;Rt.decode=sl;function el(i,t=new Map){const e=cl(i,t);return new L(e,ri(i),t)}function il(i,t=lt.V4){return new dt(i.length(),ol(i),al(i,t))}function nl(i,t=lt.V4){return new Mt(dt.decode(i.data(),t),i.id(),i.isDelta())}function sl(i){return new Rt(i.offset(),i.length())}function rl(i){return new pe(i.length(),i.nullCount())}function ol(i){const t=[];for(let e,n=-1,s=-1,r=i.nodesLength();++n<r;)(e=i.nodes(n))&&(t[++s]=pe.decode(e));return t}function al(i,t){const e=[];for(let n,s=-1,r=-1,o=i.buffersLength();++s<o;)(n=i.buffers(s))&&(t<lt.V4&&(n.bb_pos+=8*(s+1)),e[++r]=Rt.decode(n));return e}function cl(i,t){const e=[];for(let n,s=-1,r=-1,o=i.fieldsLength();++s<o;)(n=i.fields(s))&&(e[++r]=P.decode(n,t));return e}function us(i,t){const e=[];for(let n,s=-1,r=-1,o=i.childrenLength();++s<o;)(n=i.children(s))&&(e[++r]=P.decode(n,t));return e}function ll(i,t){let e,n,s,r,o,a;return!t||!(a=i.dictionary())?(s=hs(i,us(i,t)),n=new P(i.name(),s,i.nullable(),ri(i))):t.has(e=a.id().low)?(r=(r=a.indexType())?ds(r):new je,o=new Fe(t.get(e),r,e,a.isOrdered()),n=new P(i.name(),o,i.nullable(),ri(i))):(r=(r=a.indexType())?ds(r):new je,t.set(e,s=hs(i,us(i,t))),o=new Fe(s,r,e,a.isOrdered()),n=new P(i.name(),o,i.nullable(),ri(i))),n||null}function ri(i){const t=new Map;if(i)for(let e,n,s=-1,r=Math.trunc(i.customMetadataLength());++s<r;)(e=i.customMetadata(s))&&(n=e.key())!=null&&t.set(n,e.value());return t}function ds(i){return new tt(i.isSigned(),i.bitWidth())}function hs(i,t){const e=i.typeType();switch(e){case j.NONE:return new Ht;case j.Null:return new Ht;case j.Binary:return new oi;case j.Utf8:return new ai;case j.Bool:return new ci;case j.List:return new fi((t||[])[0]);case j.Struct_:return new Z(t||[])}switch(e){case j.Int:{const n=i.type(new ct);return new tt(n.isSigned(),n.bitWidth())}case j.FloatingPoint:{const n=i.type(new Bt);return new Jt(n.precision())}case j.Decimal:{const n=i.type(new it);return new li(n.scale(),n.precision(),n.bitWidth())}case j.Date:{const n=i.type(new Ft);return new ui(n.unit())}case j.Time:{const n=i.type(new pt);return new Ve(n.unit(),n.bitWidth())}case j.Timestamp:{const n=i.type(new yt);return new di(n.unit(),n.timezone())}case j.Interval:{const n=i.type(new Et);return new hi(n.unit())}case j.Union:{const n=i.type(new nt);return new pi(n.mode(),n.typeIdsArray()||[],t||[])}case j.FixedSizeBinary:{const n=i.type(new Ot);return new yi(n.byteWidth())}case j.FixedSizeList:{const n=i.type(new Tt);return new mi(n.listSize(),(t||[])[0])}case j.Map:{const n=i.type(new Nt);return new _i((t||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${j[e]}" (${e})`)}function ul(i,t){const e=t.fields.map(r=>P.encode(i,r));$.startFieldsVector(i,e.length);const n=$.createFieldsVector(i,e),s=t.metadata&&t.metadata.size>0?$.createCustomMetadataVector(i,[...t.metadata].map(([r,o])=>{const a=i.createString(`${r}`),c=i.createString(`${o}`);return W.startKeyValue(i),W.addKey(i,a),W.addValue(i,c),W.endKeyValue(i)})):-1;return $.startSchema(i),$.addFields(i,n),$.addEndianness(i,ml?Te.Little:Te.Big),s!==-1&&$.addCustomMetadata(i,s),$.endSchema(i)}function dl(i,t){let e=-1,n=-1,s=-1;const r=t.type;let o=t.typeId;y.isDictionary(r)?(o=r.dictionary.typeId,s=Qi.visit(r,i),n=Qi.visit(r.dictionary,i)):n=Qi.visit(r,i);const a=(r.children||[]).map(d=>P.encode(i,d)),c=Q.createChildrenVector(i,a),u=t.metadata&&t.metadata.size>0?Q.createCustomMetadataVector(i,[...t.metadata].map(([d,h])=>{const f=i.createString(`${d}`),x=i.createString(`${h}`);return W.startKeyValue(i),W.addKey(i,f),W.addValue(i,x),W.endKeyValue(i)})):-1;return t.name&&(e=i.createString(t.name)),Q.startField(i),Q.addType(i,n),Q.addTypeType(i,o),Q.addChildren(i,c),Q.addNullable(i,!!t.nullable),e!==-1&&Q.addName(i,e),s!==-1&&Q.addDictionary(i,s),u!==-1&&Q.addCustomMetadata(i,u),Q.endField(i)}function hl(i,t){const e=t.nodes||[],n=t.buffers||[];ft.startNodesVector(i,e.length);for(const o of e.slice().reverse())pe.encode(i,o);const s=i.endVector();ft.startBuffersVector(i,n.length);for(const o of n.slice().reverse())Rt.encode(i,o);const r=i.endVector();return ft.startRecordBatch(i),ft.addLength(i,new fe(t.length,0)),ft.addNodes(i,s),ft.addBuffers(i,r),ft.endRecordBatch(i)}function fl(i,t){const e=dt.encode(i,t.data);return Pt.startDictionaryBatch(i),Pt.addId(i,new fe(t.id,0)),Pt.addIsDelta(i,t.isDelta),Pt.addData(i,e),Pt.endDictionaryBatch(i)}function pl(i,t){return Kr.createFieldNode(i,new fe(t.length,0),new fe(t.nullCount,0))}function yl(i,t){return Jr.createBuffer(i,new fe(t.offset,0),new fe(t.length,0))}const ml=(()=>{const i=new ArrayBuffer(2);return new DataView(i).setInt16(0,256,!0),new Int16Array(i)[0]===256})(),Un=i=>`Expected ${D[i]} Message in stream, but was null or length 0.`,kn=i=>`Header pointer of flatbuffer-encoded ${D[i]} Message is null or length 0.`,Xr=(i,t)=>`Expected to read ${i} metadata bytes, but only read ${t}.`,to=(i,t)=>`Expected to read ${i} bytes for message body, but only read ${t}.`;class eo{constructor(t){this.source=t instanceof Oi?t:new Oi(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||t.value===-1&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?V:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let e;if((e=this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(Un(t));return e.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const e=E(this.source.read(t));if(e.byteLength<t)throw new Error(to(t,e.byteLength));return e.byteOffset%8===0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}readSchema(t=!1){const e=D.Schema,n=this.readMessage(e),s=n==null?void 0:n.header();if(t&&!s)throw new Error(kn(e));return s}readMetadataLength(){const t=this.source.read(zi),e=t&&new Qt(t),n=(e==null?void 0:e.readInt32(0))||0;return{done:n===0,value:n}}readMetadata(t){const e=this.source.read(t);if(!e)return V;if(e.byteLength<t)throw new Error(Xr(t,e.byteLength));return{done:!1,value:X.decode(e)}}}class _l{constructor(t,e){this.source=t instanceof Ee?t:Fs(t)?new Ti(t,e):new Ee(t)}[Symbol.asyncIterator](){return this}next(){return p(this,void 0,void 0,function*(){let t;return(t=yield this.readMetadataLength()).done||t.value===-1&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?V:t})}throw(t){return p(this,void 0,void 0,function*(){return yield this.source.throw(t)})}return(t){return p(this,void 0,void 0,function*(){return yield this.source.return(t)})}readMessage(t){return p(this,void 0,void 0,function*(){let e;if((e=yield this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(Un(t));return e.value})}readMessageBody(t){return p(this,void 0,void 0,function*(){if(t<=0)return new Uint8Array(0);const e=E(yield this.source.read(t));if(e.byteLength<t)throw new Error(to(t,e.byteLength));return e.byteOffset%8===0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()})}readSchema(t=!1){return p(this,void 0,void 0,function*(){const e=D.Schema,n=yield this.readMessage(e),s=n==null?void 0:n.header();if(t&&!s)throw new Error(kn(e));return s})}readMetadataLength(){return p(this,void 0,void 0,function*(){const t=yield this.source.read(zi),e=t&&new Qt(t),n=(e==null?void 0:e.readInt32(0))||0;return{done:n===0,value:n}})}readMetadata(t){return p(this,void 0,void 0,function*(){const e=yield this.source.read(t);if(!e)return V;if(e.byteLength<t)throw new Error(Xr(t,e.byteLength));return{done:!1,value:X.decode(e)}})}}class bl extends eo{constructor(t){super(new Uint8Array(0));this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof ss?t:new ss(t)}next(){const{_json:t}=this;if(!this._schema){this._schema=!0;const e=X.fromJSON(t.schema,D.Schema);return{done:!1,value:e}}if(this._dictionaryIndex<t.dictionaries.length){const e=t.dictionaries[this._dictionaryIndex++];this._body=e.data.columns;const n=X.fromJSON(e,D.DictionaryBatch);return{done:!1,value:n}}if(this._batchIndex<t.batches.length){const e=t.batches[this._batchIndex++];this._body=e.columns;const n=X.fromJSON(e,D.RecordBatch);return{done:!1,value:n}}return this._body=[],V}readMessageBody(t){return e(this._body);function e(n){return(n||[]).reduce((s,r)=>[...s,...r.VALIDITY&&[r.VALIDITY]||[],...r.TYPE&&[r.TYPE]||[],...r.OFFSET&&[r.OFFSET]||[],...r.DATA&&[r.DATA]||[],...e(r.children)],[])}}readMessage(t){let e;if((e=this.next()).done)return null;if(t!=null&&e.value.headerType!==t)throw new Error(Un(t));return e.value}readSchema(){const t=D.Schema,e=this.readMessage(t),n=e==null?void 0:e.header();if(!e||!n)throw new Error(kn(t));return n}}const zi=4,un="ARROW1",$e=new Uint8Array(un.length);for(let i=0;i<un.length;i+=1)$e[i]=un.codePointAt(i);function xn(i,t=0){for(let e=-1,n=$e.length;++e<n;)if($e[e]!==i[t+e])return!1;return!0}const Ke=$e.length,io=Ke+zi,gl=Ke*2+zi;class _t extends En{constructor(t){super();this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const e=this._impl.open(t);return he(e)?e.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return ht.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return ht.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof _t?t:tn(t)?Sl(t):Fs(t)?Ol(t):he(t)?(()=>p(this,void 0,void 0,function*(){return yield _t.from(yield t)}))():Os(t)||yn(t)||Ts(t)||De(t)?Fl(new Ee(t)):Al(new Oi(t))}static readAll(t){return t instanceof _t?t.isSync()?fs(t):ps(t):tn(t)||ArrayBuffer.isView(t)||We(t)||As(t)?fs(t):ps(t)}}class Di extends _t{constructor(t){super(t);this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return Dt(this,arguments,function*(){yield A(yield*ii(ue(this[Symbol.iterator]())))})}}class Ri extends _t{constructor(t){super(t);this._impl=t}readAll(){var t,e;return p(this,void 0,void 0,function*(){const n=new Array;try{for(var s=ue(this),r;r=yield s.next(),!r.done;){const o=r.value;n.push(o)}}catch(o){t={error:o}}finally{try{r&&!r.done&&(e=s.return)&&(yield e.call(s))}finally{if(t)throw t.error}}return n})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class no extends Di{constructor(t){super(t);this._impl=t}}class wl extends Ri{constructor(t){super(t);this._impl=t}}class so{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,e){const n=this._loadVectors(t,e,this.schema.fields),s=O({type:new Z(this.schema.fields),length:t.length,children:n});return new G(this.schema,s)}_loadDictionaryBatch(t,e){const{id:n,isDelta:s}=t,{dictionaries:r,schema:o}=this,a=r.get(n);if(s||!a){const c=o.dictionaries.get(n),u=this._loadVectors(t.data,e,[c]);return(a&&s?a.concat(new R(u)):new R(u)).memoize()}return a.memoize()}_loadVectors(t,e,n){return new Yr(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}class Li extends so{constructor(t,e){super(e);this._reader=tn(t)?new bl(this._handle=t):new eo(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=oo(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):V}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):V}next(){if(this.closed)return V;let t;const{_reader:e}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),s=e.readMessageBody(t.bodyLength),r=this._loadRecordBatch(n,s);return{done:!1,value:r}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),s=e.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(n,s);this.dictionaries.set(n.id,r)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Mn(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class Mi extends so{constructor(t,e){super(e);this._reader=new _l(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return p(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(t){return p(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=oo(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(t){return p(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):V})}return(t){return p(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):V})}next(){return p(this,void 0,void 0,function*(){if(this.closed)return V;let t;const{_reader:e}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),s=yield e.readMessageBody(t.bodyLength),r=this._loadRecordBatch(n,s);return{done:!1,value:r}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),s=yield e.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(n,s);this.dictionaries.set(n.id,r)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new Mn(this.schema)}):yield this.return()})}_readNextMessageAndValidate(t){return p(this,void 0,void 0,function*(){return yield this._reader.readMessage(t)})}}class ro extends Li{constructor(t,e){super(t instanceof rs?t:new rs(t),e)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const e of this._footer.dictionaryBatches())e&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var e;if(this.closed)return null;this._footer||this.open();const n=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(t);if(n&&this._handle.seek(n.offset)){const s=this._reader.readMessage(D.RecordBatch);if(s==null?void 0:s.isRecordBatch()){const r=s.header(),o=this._reader.readMessageBody(s.bodyLength);return this._loadRecordBatch(r,o)}}return null}_readDictionaryBatch(t){var e;const n=(e=this._footer)===null||e===void 0?void 0:e.getDictionaryBatch(t);if(n&&this._handle.seek(n.offset)){const s=this._reader.readMessage(D.DictionaryBatch);if(s==null?void 0:s.isDictionaryBatch()){const r=s.header(),o=this._reader.readMessageBody(s.bodyLength),a=this._loadDictionaryBatch(r,o);this.dictionaries.set(r.id,a)}}}_readFooter(){const{_handle:t}=this,e=t.size-io,n=t.readInt32(e),s=t.readAt(e-n,n);return ze.decode(s)}_readNextMessageAndValidate(t){var e;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(t)}return null}}class vl extends Mi{constructor(t,...e){const n=typeof e[0]!="number"?e.shift():void 0,s=e[0]instanceof Map?e.shift():void 0;super(t instanceof Ti?t:new Ti(t,n),s)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){const e=Object.create(null,{open:{get:()=>super.open}});return p(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const n of this._footer.dictionaryBatches())n&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield e.open.call(this,t)})}readRecordBatch(t){var e;return p(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());const n=(e=this._footer)===null||e===void 0?void 0:e.getRecordBatch(t);if(n&&(yield this._handle.seek(n.offset))){const s=yield this._reader.readMessage(D.RecordBatch);if(s==null?void 0:s.isRecordBatch()){const r=s.header(),o=yield this._reader.readMessageBody(s.bodyLength);return this._loadRecordBatch(r,o)}}return null})}_readDictionaryBatch(t){var e;return p(this,void 0,void 0,function*(){const n=(e=this._footer)===null||e===void 0?void 0:e.getDictionaryBatch(t);if(n&&(yield this._handle.seek(n.offset))){const s=yield this._reader.readMessage(D.DictionaryBatch);if(s==null?void 0:s.isDictionaryBatch()){const r=s.header(),o=yield this._reader.readMessageBody(s.bodyLength),a=this._loadDictionaryBatch(r,o);this.dictionaries.set(r.id,a)}}})}_readFooter(){return p(this,void 0,void 0,function*(){const{_handle:t}=this;t._pending&&(yield t._pending);const e=t.size-io,n=yield t.readInt32(e),s=yield t.readAt(e-n,n);return ze.decode(s)})}_readNextMessageAndValidate(t){return p(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const e=this._footer.getRecordBatch(this._recordBatchIndex);if(e&&(yield this._handle.seek(e.offset)))return yield this._reader.readMessage(t)}return null})}}class Il extends Li{constructor(t,e){super(t,e)}_loadVectors(t,e,n){return new Mc(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}function oo(i,t){return t&&typeof t.autoDestroy=="boolean"?t.autoDestroy:i.autoDestroy}function*fs(i){const t=_t.from(i);try{if(!t.open({autoDestroy:!1}).closed)do yield t;while(!t.reset().open().closed)}finally{t.cancel()}}function ps(i){return Dt(this,arguments,function*(){const e=yield A(_t.from(i));try{if(!(yield A(e.open({autoDestroy:!1}))).closed)do yield yield A(e);while(!(yield A(e.reset().open())).closed)}finally{yield A(e.cancel())}})}function Sl(i){return new Di(new Il(i))}function Al(i){const t=i.peek(Ke+7&-8);return t&&t.byteLength>=4?xn(t)?new no(new ro(i.read())):new Di(new Li(i)):new Di(new Li(function*(){}()))}function Fl(i){return p(this,void 0,void 0,function*(){const t=yield i.peek(Ke+7&-8);return t&&t.byteLength>=4?xn(t)?new no(new ro(yield i.read())):new Ri(new Mi(i)):new Ri(new Mi(function(){return Dt(this,arguments,function*(){})}()))})}function Ol(i){return p(this,void 0,void 0,function*(){const{size:t}=yield i.stat(),e=new Ti(i,t);return t>=gl&&xn(yield e.readAt(0,Ke+7&-8))?new wl(new vl(e)):new Ri(new Mi(e))})}class z extends T{constructor(){super();this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...t){const e=s=>s.flatMap(r=>Array.isArray(r)?e(r):r instanceof G?r.data.children:r.data),n=new z;return n.visitMany(e(t)),n}visit(t){if(t instanceof R)return this.visitMany(t.data),this;const{type:e}=t;if(!y.isDictionary(e)){const{length:n,nullCount:s}=t;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");y.isNull(e)||wt.call(this,s<=0?new Uint8Array(0):An(t.offset,n,t.nullBitmap)),this.nodes.push(new pe(n,s))}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function wt(i){const t=i.byteLength+7&-8;return this.buffers.push(i),this.bufferRegions.push(new Rt(this._byteLength,t)),this._byteLength+=t,this}function Tl(i){const{type:t,length:e,typeIds:n,valueOffsets:s}=i;if(wt.call(this,n),t.mode===ut.Sparse)return dn.call(this,i);if(t.mode===ut.Dense){if(i.offset<=0)return wt.call(this,s),dn.call(this,i);{const r=n.reduce((d,h)=>Math.max(d,h),n[0]),o=new Int32Array(r+1),a=new Int32Array(r+1).fill(-1),c=new Int32Array(e),u=_n(-s[0],e,s);for(let d,h,f=-1;++f<e;)(h=a[d=n[f]])===-1&&(h=a[d]=u[d]),c[f]=u[f]-h,++o[d];wt.call(this,c);for(let d,h=-1,f=t.children.length;++h<f;)if(d=i.children[h]){const x=t.typeIds[h],J=Math.min(e,o[x]);this.visit(d.slice(a[x],J))}}}return this}function Bl(i){let t;return i.nullCount>=i.length?wt.call(this,new Uint8Array(0)):(t=i.values)instanceof Uint8Array?wt.call(this,An(i.offset,i.length,t)):wt.call(this,bi(i.values))}function ee(i){return wt.call(this,i.values.subarray(0,i.length*i.stride))}function ao(i){const{length:t,values:e,valueOffsets:n}=i,s=n[0],r=n[t],o=Math.min(r-s,e.byteLength-s);return wt.call(this,_n(-n[0],t,n)),wt.call(this,e.subarray(s,s+o)),this}function Cn(i){const{length:t,valueOffsets:e}=i;return e&&wt.call(this,_n(e[0],t,e)),this.visit(i.children[0])}function dn(i){return this.visitMany(i.type.children.map((t,e)=>i.children[e]).filter(Boolean))[0]}z.prototype.visitBool=Bl;z.prototype.visitInt=ee;z.prototype.visitFloat=ee;z.prototype.visitUtf8=ao;z.prototype.visitBinary=ao;z.prototype.visitFixedSizeBinary=ee;z.prototype.visitDate=ee;z.prototype.visitTimestamp=ee;z.prototype.visitTime=ee;z.prototype.visitDecimal=ee;z.prototype.visitList=Cn;z.prototype.visitStruct=dn;z.prototype.visitUnion=Tl;z.prototype.visitInterval=ee;z.prototype.visitFixedSizeList=Cn;z.prototype.visitMap=Cn;class co extends En{constructor(t){super();this._position=0,this._started=!1,this._sink=new ni,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,st(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return he(t)?t.then(e=>this.writeAll(e)):De(t)?zn(this,t):Vn(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,e=null){return t===this._sink||t instanceof ni?this._sink=t:(this._sink=new ni,t&&jo(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&Vo(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!e||!ln(e,this._schema))&&(e==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=e,this._writeSchema(e))),this}write(t){let e=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof q&&!(e=t.schema))return this.finish()&&void 0;if(t instanceof G&&!(e=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(e&&!ln(e,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,e)}t instanceof G?t instanceof Mn||this._writeRecordBatch(t):t instanceof q?this.writeAll(t.batches):We(t)&&this.writeAll(t)}_writeMessage(t,e=8){const n=e-1,s=X.encode(t),r=s.byteLength,o=this._writeLegacyIpcFormat?4:8,a=r+o+n&~n,c=a-r-o;return t.headerType===D.RecordBatch?this._recordBatchBlocks.push(new qt(a,t.bodyLength,this._position)):t.headerType===D.DictionaryBatch&&this._dictionaryBlocks.push(new qt(a,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(a-o)),r>0&&this._write(s),this._writePadding(c)}_write(t){if(this._started){const e=E(t);e&&e.byteLength>0&&(this._sink.write(e),this._position+=e.byteLength)}return this}_writeSchema(t){return this._writeMessage(X.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write($e)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){const{byteLength:e,nodes:n,bufferRegions:s,buffers:r}=z.assemble(t),o=new dt(t.numRows,n,s),a=X.from(o,e);return this._writeDictionaries(t)._writeMessage(a)._writeBodyBuffers(r)}_writeDictionaryBatch(t,e,n=!1){this._dictionaryDeltaOffsets.set(e,t.length+(this._dictionaryDeltaOffsets.get(e)||0));const{byteLength:s,nodes:r,bufferRegions:o,buffers:a}=z.assemble(new R([t])),c=new dt(t.length,r,o),u=new Mt(c,e,n),d=X.from(u,s);return this._writeMessage(d)._writeBodyBuffers(a)}_writeBodyBuffers(t){let e,n,s;for(let r=-1,o=t.length;++r<o;)(e=t[r])&&(n=e.byteLength)>0&&(this._write(e),(s=(n+7&-8)-n)>0&&this._writePadding(s));return this}_writeDictionaries(t){for(let[e,n]of t.dictionaries){let s=this._dictionaryDeltaOffsets.get(e)||0;if(s===0||(n=n==null?void 0:n.slice(s)).length>0)for(const r of n.data)this._writeDictionaryBatch(r,e,s>0),s+=r.length}return this}}class Pn extends co{static writeAll(t,e){const n=new Pn(e);return he(t)?t.then(s=>n.writeAll(s)):De(t)?zn(n,t):Vn(n,t)}}class jn extends co{static writeAll(t){const e=new jn;return he(t)?t.then(n=>e.writeAll(n)):De(t)?zn(e,t):Vn(e,t)}constructor(){super();this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){const e=ze.encode(new ze(t,lt.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(e)._write(Int32Array.of(e.byteLength))._writeMagic()}}function Vn(i,t){let e=t;t instanceof q&&(e=t.batches,i.reset(void 0,t.schema));for(const n of e)i.write(n);return i.finish()}function zn(i,t){var e,n,s,r;return p(this,void 0,void 0,function*(){try{for(e=ue(t);n=yield e.next(),!n.done;){const o=n.value;i.write(o)}}catch(o){s={error:o}}finally{try{n&&!n.done&&(r=e.return)&&(yield r.call(e))}finally{if(s)throw s.error}}return i.finish()})}function El(i,t="stream"){return(t==="stream"?Pn:jn).writeAll(i).toUint8Array(!0)}var Nl=Object.create,$n=Object.defineProperty,Dl=Object.getOwnPropertyDescriptor,Rl=Object.getOwnPropertyNames,Ll=Object.getPrototypeOf,Ml=Object.prototype.hasOwnProperty,Ul=i=>$n(i,"__esModule",{value:!0}),kl=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports),xl=(i,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Rl(t))!Ml.call(i,s)&&(e||s!=="default")&&$n(i,s,{get:()=>t[s],enumerable:!(n=Dl(t,s))||n.enumerable});return i},Cl=(i,t)=>xl(Ul($n(i!=null?Nl(Ll(i)):{},"default",!t&&i&&i.__esModule?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i),Pl=kl((i,t)=>{t.exports=Worker}),jl=(i=>(i[i.NONE=0]="NONE",i[i.DEBUG=1]="DEBUG",i[i.INFO=2]="INFO",i[i.WARNING=3]="WARNING",i[i.ERROR=4]="ERROR",i))(jl||{}),Vl=(i=>(i[i.NONE=0]="NONE",i[i.CONNECT=1]="CONNECT",i[i.DISCONNECT=2]="DISCONNECT",i[i.OPEN=3]="OPEN",i[i.QUERY=4]="QUERY",i[i.INSTANTIATE=5]="INSTANTIATE",i))(Vl||{}),zl=(i=>(i[i.NONE=0]="NONE",i[i.OK=1]="OK",i[i.ERROR=2]="ERROR",i[i.START=3]="START",i[i.RUN=4]="RUN",i[i.CAPTURE=5]="CAPTURE",i))(zl||{}),$l=(i=>(i[i.NONE=0]="NONE",i[i.WEB_WORKER=1]="WEB_WORKER",i[i.NODE_WORKER=2]="NODE_WORKER",i[i.BINDINGS=3]="BINDINGS",i[i.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",i))($l||{}),Gu=class{constructor(i=2){this.level=i}log(i){i.level>=this.level&&console.log(i)}},Yl=(i=>(i[i.SUCCESS=0]="SUCCESS",i))(Yl||{}),Wl=class{constructor(i,t){this._bindings=i,this._conn=t}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(i){return i(this._bindings,this._conn)}async query(i){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:i});let t=await this._bindings.runQuery(this._conn,i),e=_t.from(t);return console.assert(e.isSync()),console.assert(e.isFile()),new q(e)}async send(i){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:i});let t=await this._bindings.sendQuery(this._conn,i),e=new lo(this._bindings,this._conn,t),n=await _t.from(e);return console.assert(n.isAsync()),console.assert(n.isStream()),n}async getTableNames(i){return await this._bindings.getTableNames(this._conn,i)}async prepare(i){let t=await this._bindings.createPrepared(this._conn,i);return new Gl(this._bindings,this._conn,t)}async insertArrowTable(i,t){let e=El(i,"stream");await this.insertArrowFromIPCStream(e,t)}async insertArrowFromIPCStream(i,t){await this._bindings.insertArrowFromIPCStream(this._conn,i,t)}async insertCSVFromPath(i,t){await this._bindings.insertCSVFromPath(this._conn,i,t)}async insertJSONFromPath(i,t){await this._bindings.insertJSONFromPath(this._conn,i,t)}},lo=class{constructor(i,t,e){this.db=i,this.conn=t,this.header=e,this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let i;return this._inFlight!=null?(i=await this._inFlight,this._inFlight=null):i=await this.db.fetchQueryResults(this.conn),this._depleted=i.length==0,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:i}}[Symbol.asyncIterator](){return this}},Gl=class{constructor(i,t,e){this.bindings=i,this.connectionId=t,this.statementId=e}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...i){let t=await this.bindings.runPrepared(this.connectionId,this.statementId,i),e=_t.from(t);return console.assert(e.isSync()),console.assert(e.isFile()),new q(e)}async send(...i){let t=await this.bindings.sendPrepared(this.connectionId,this.statementId,i),e=new lo(this.bindings,this.connectionId,t),n=await _t.from(e);return console.assert(n.isAsync()),console.assert(n.isStream()),n}},Hl=(i=>(i.CLOSE_PREPARED="CLOSE_PREPARED",i.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",i.CONNECT="CONNECT",i.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",i.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",i.CREATE_PREPARED="CREATE_PREPARED",i.DISCONNECT="DISCONNECT",i.DROP_FILE="DROP_FILE",i.DROP_FILES="DROP_FILES",i.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",i.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",i.FLUSH_FILES="FLUSH_FILES",i.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",i.GET_TABLE_NAMES="GET_TABLE_NAMES",i.GET_VERSION="GET_VERSION",i.GLOB_FILE_INFOS="GLOB_FILE_INFOS",i.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",i.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",i.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",i.INSTANTIATE="INSTANTIATE",i.OPEN="OPEN",i.PING="PING",i.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",i.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",i.REGISTER_FILE_URL="REGISTER_FILE_URL",i.RESET="RESET",i.RUN_PREPARED="RUN_PREPARED",i.RUN_QUERY="RUN_QUERY",i.SEND_PREPARED="SEND_PREPARED",i.SEND_QUERY="SEND_QUERY",i.TOKENIZE="TOKENIZE",i))(Hl||{}),Jl=(i=>(i.CONNECTION_INFO="CONNECTION_INFO",i.ERROR="ERROR",i.FEATURE_FLAGS="FEATURE_FLAGS",i.FILE_BUFFER="FILE_BUFFER",i.FILE_INFOS="FILE_INFOS",i.FILE_SIZE="FILE_SIZE",i.FILE_STATISTICS="FILE_STATISTICS",i.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",i.LOG="LOG",i.OK="OK",i.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",i.QUERY_PLAN="QUERY_PLAN",i.QUERY_RESULT="QUERY_RESULT",i.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",i.QUERY_START="QUERY_START",i.REGISTERED_FILE="REGISTERED_FILE",i.SCRIPT_TOKENS="SCRIPT_TOKENS",i.SUCCESS="SUCCESS",i.TABLE_NAMES="TABLE_NAMES",i.VERSION_STRING="VERSION_STRING",i))(Jl||{}),B=class{constructor(i,t){this.promiseResolver=()=>{},this.promiseRejecter=()=>{},this.type=i,this.data=t,this.promise=new Promise((e,n)=>{this.promiseResolver=e,this.promiseRejecter=n})}};function Kl(i){switch(i.typeId){case l.Binary:return{type:"binary"};case l.Bool:return{type:"bool"};case l.Date:return{type:"date"};case l.DateDay:return{type:"date32[d]"};case l.DateMillisecond:return{type:"date64[ms]"};case l.Decimal:{let t=i;return{type:"decimal",precision:t.precision,scale:t.scale}}case l.Float:return{type:"float"};case l.Float16:return{type:"float16"};case l.Float32:return{type:"float32"};case l.Float64:return{type:"float64"};case l.Int:return{type:"int32"};case l.Int16:return{type:"int16"};case l.Int32:return{type:"int32"};case l.Int64:return{type:"int64"};case l.Uint16:return{type:"uint16"};case l.Uint32:return{type:"uint32"};case l.Uint64:return{type:"uint64"};case l.Uint8:return{type:"uint8"};case l.IntervalDayTime:return{type:"interval[dt]"};case l.IntervalYearMonth:return{type:"interval[m]"};case l.List:{let t=i;return{type:"list",children:[Ui(t.valueField.name,t.valueField.type)]}}case l.FixedSizeBinary:return{type:"fixedsizebinary",byteWidth:i.byteWidth};case l.Null:return{type:"null"};case l.Utf8:return{type:"utf8"};case l.Struct:return{type:"struct",children:i.children.map(t=>Ui(t.name,t.type))};case l.Time:return{type:"time[s]"};case l.TimeMicrosecond:return{type:"time[us]"};case l.TimeMillisecond:return{type:"time[ms]"};case l.TimeNanosecond:return{type:"time[ns]"};case l.TimeSecond:return{type:"time[s]"};case l.Timestamp:return{type:"timestamp",timezone:i.timezone||void 0};case l.TimestampSecond:return{type:"timestamp[s]",timezone:i.timezone||void 0};case l.TimestampMicrosecond:return{type:"timestamp[us]",timezone:i.timezone||void 0};case l.TimestampNanosecond:return{type:"timestamp[ns]",timezone:i.timezone||void 0};case l.TimestampMillisecond:return{type:"timestamp[ms]",timezone:i.timezone||void 0}}throw new Error(`unsupported arrow type: ${i.toString()}`)}function Ui(i,t){let e=Kl(t);return e.name=i,e}var Ql=new TextEncoder,Hu=class{constructor(i,t=null){this._onInstantiationProgress=[],this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{},this._nextMessageId=0,this._pendingRequests=new Map,this._logger=i,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),t!=null&&this.attach(t)}get logger(){return this._logger}attach(i){this._worker=i,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((t,e)=>{this._workerShutdownResolver=t})}detach(){!this._worker||(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){!this._worker||(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(i,t=[]){if(!this._worker){console.error("cannot send a message since the worker is not set!");return}let e=this._nextMessageId++;return this._pendingRequests.set(e,i),this._worker.postMessage({messageId:e,type:i.type,data:i.data},t),await i.promise}onMessage(i){let t=i.data;switch(t.type){case"LOG":{this._logger.log(t.data);return}case"INSTANTIATE_PROGRESS":{for(let n of this._onInstantiationProgress)n(t.data);return}}let e=this._pendingRequests.get(t.requestId);if(!e){console.warn(`unassociated response: [${t.requestId}, ${t.type.toString()}]`);return}if(this._pendingRequests.delete(t.requestId),t.type=="ERROR"){let n=new Error(t.data.message);n.name=t.data.name,n.stack=t.data.stack,e.promiseRejecter(n);return}switch(e.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if(t.type=="OK"){e.promiseResolver(t.data);return}break;case"INSTANTIATE":if(this._onInstantiationProgress=[],t.type=="OK"){e.promiseResolver(t.data);return}break;case"GLOB_FILE_INFOS":if(t.type=="FILE_INFOS"){e.promiseResolver(t.data);return}break;case"GET_VERSION":if(t.type=="VERSION_STRING"){e.promiseResolver(t.data);return}break;case"GET_FEATURE_FLAGS":if(t.type=="FEATURE_FLAGS"){e.promiseResolver(t.data);return}break;case"GET_TABLE_NAMES":if(t.type=="TABLE_NAMES"){e.promiseResolver(t.data);return}break;case"TOKENIZE":if(t.type=="SCRIPT_TOKENS"){e.promiseResolver(t.data);return}break;case"COPY_FILE_TO_BUFFER":if(t.type=="FILE_BUFFER"){e.promiseResolver(t.data);return}break;case"EXPORT_FILE_STATISTICS":if(t.type=="FILE_STATISTICS"){e.promiseResolver(t.data);return}break;case"CONNECT":if(t.type=="CONNECTION_INFO"){e.promiseResolver(t.data);return}break;case"RUN_PREPARED":case"RUN_QUERY":if(t.type=="QUERY_RESULT"){e.promiseResolver(t.data);return}break;case"SEND_PREPARED":case"SEND_QUERY":if(t.type=="QUERY_START"){e.promiseResolver(t.data);return}break;case"FETCH_QUERY_RESULTS":if(t.type=="QUERY_RESULT_CHUNK"){e.promiseResolver(t.data);return}break;case"CREATE_PREPARED":if(t.type=="PREPARED_STATEMENT_ID"){e.promiseResolver(t.data);return}break}e.promiseRejecter(new Error(`unexpected response type: ${t.type.toString()}`))}onError(i){console.error(i),console.error(`error in duckdb worker: ${i.message}`),this._pendingRequests.clear()}onClose(){if(this._workerShutdownResolver(null),this._pendingRequests.size!=0){console.warn(`worker terminated with ${this._pendingRequests.size} pending requests`);return}this._pendingRequests.clear()}async reset(){let i=new B("RESET",null);return await this.postTask(i)}async ping(){let i=new B("PING",null);await this.postTask(i)}async dropFile(i){let t=new B("DROP_FILE",i);return await this.postTask(t)}async dropFiles(){let i=new B("DROP_FILES",null);return await this.postTask(i)}async flushFiles(){let i=new B("FLUSH_FILES",null);return await this.postTask(i)}async instantiate(i,t=null,e=n=>{}){this._onInstantiationProgress.push(e);let n=new B("INSTANTIATE",[i,t]);return await this.postTask(n)}async getVersion(){let i=new B("GET_VERSION",null);return await this.postTask(i)}async getFeatureFlags(){let i=new B("GET_FEATURE_FLAGS",null);return await this.postTask(i)}async open(i){let t=new B("OPEN",i);await this.postTask(t)}async tokenize(i){let t=new B("TOKENIZE",i);return await this.postTask(t)}async connectInternal(){let i=new B("CONNECT",null);return await this.postTask(i)}async connect(){let i=await this.connectInternal();return new Wl(this,i)}async disconnect(i){let t=new B("DISCONNECT",i);await this.postTask(t)}async runQuery(i,t){let e=new B("RUN_QUERY",[i,t]);return await this.postTask(e)}async sendQuery(i,t){let e=new B("SEND_QUERY",[i,t]);return await this.postTask(e)}async fetchQueryResults(i){let t=new B("FETCH_QUERY_RESULTS",i);return await this.postTask(t)}async getTableNames(i,t){let e=new B("GET_TABLE_NAMES",[i,t]);return await this.postTask(e)}async createPrepared(i,t){let e=new B("CREATE_PREPARED",[i,t]);return await this.postTask(e)}async closePrepared(i,t){let e=new B("CLOSE_PREPARED",[i,t]);await this.postTask(e)}async runPrepared(i,t,e){let n=new B("RUN_PREPARED",[i,t,e]);return await this.postTask(n)}async sendPrepared(i,t,e){let n=new B("SEND_PREPARED",[i,t,e]);return await this.postTask(n)}async globFiles(i){let t=new B("GLOB_FILE_INFOS",i);return await this.postTask(t)}async registerFileText(i,t){let e=Ql.encode(t);await this.registerFileBuffer(i,e)}async registerFileURL(i,t){t===void 0&&(t=i);let e=new B("REGISTER_FILE_URL",[i,t]);await this.postTask(e)}async registerEmptyFileBuffer(i){let t=new B("REGISTER_FILE_BUFFER",[i,new Uint8Array]);await this.postTask(t)}async registerFileBuffer(i,t){let e=new B("REGISTER_FILE_BUFFER",[i,t]);await this.postTask(e,[t.buffer])}async registerFileHandle(i,t){let e=new B("REGISTER_FILE_HANDLE",[i,t]);await this.postTask(e,[])}async collectFileStatistics(i,t){let e=new B("COLLECT_FILE_STATISTICS",[i,t]);await this.postTask(e,[])}async exportFileStatistics(i){let t=new B("EXPORT_FILE_STATISTICS",i);return await this.postTask(t,[])}async copyFileToBuffer(i){let t=new B("COPY_FILE_TO_BUFFER",i);return await this.postTask(t)}async copyFileToPath(i,t){let e=new B("COPY_FILE_TO_PATH",[i,t]);await this.postTask(e)}async insertArrowFromIPCStream(i,t,e){if(t.length==0)return;let n=new B("INSERT_ARROW_FROM_IPC_STREAM",[i,t,e]);await this.postTask(n,[t.buffer])}async insertCSVFromPath(i,t,e){if(e.columns!==void 0){let s=[];for(let r in e.columns){let o=e.columns[r];s.push(Ui(r,o))}e.columnsFlat=s,delete e.columns}let n=new B("IMPORT_CSV_FROM_PATH",[i,t,e]);await this.postTask(n)}async insertJSONFromPath(i,t,e){if(e.columns!==void 0){let s=[];for(let r in e.columns){let o=e.columns[r];s.push(Ui(r,o))}e.columnsFlat=s,delete e.columns}let n=new B("IMPORT_JSON_FROM_PATH",[i,t,e]);await this.postTask(n)}},ql="@duckdb/duckdb-wasm",Zl="1.13.1-dev240.0",Xl="DuckDB powered by WebAssembly",tu="MPL-2.0",eu={type:"git",url:"https://github.com/duckdb/duckdb-wasm.git"},iu=["sql","duckdb","relational","database","data","query","wasm","analytics","olap","arrow","parquet","json","csv"],nu={"apache-arrow":"^7.0.0"},su={"@types/emscripten":"^1.39.6","@types/jasmine":"^3.10.3","@typescript-eslint/eslint-plugin":"^5.12.1","@typescript-eslint/parser":"^5.12.1",esbuild:"^0.14.23",eslint:"^8.10.0","eslint-plugin-jasmine":"^4.1.3","eslint-plugin-react":"^7.29.2","fast-glob":"^3.2.11",jasmine:"^4.0.2","jasmine-core":"^4.0.1","jasmine-spec-reporter":"^7.0.0","js-sha256":"^0.9.0",karma:"^6.3.16","karma-chrome-launcher":"^3.1.0","karma-coverage":"^2.2.0","karma-firefox-launcher":"^2.1.2","karma-jasmine":"^4.0.1","karma-jasmine-html-reporter":"^1.7.0","karma-sourcemap-loader":"^0.3.8","karma-spec-reporter":"^0.0.33","make-dir":"^3.1.0",nyc:"^15.1.0",prettier:"^2.5.1",puppeteer:"^13.4.0",rimraf:"^3.0.2",s3rver:"^3.7.1",typedoc:"^0.22.12",typescript:"^4.5.5","wasm-feature-detect":"^1.2.11","web-worker":"^1.2.0"},ru={"build:debug":"node bundle.mjs debug && tsc --emitDeclarationOnly","build:release":"node bundle.mjs release && tsc --emitDeclarationOnly",docs:"typedoc",report:"node ./coverage.mjs","test:node":"node --enable-source-maps --experimental-wasm-eh ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:debug":"node --inspect-brk --enable-source-maps --experimental-wasm-eh ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:coverage":"nyc -r json --report-dir ./coverage/node node --experimental-wasm-eh ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:firefox":"karma start ./karma/tests-firefox.cjs","test:chrome":"karma start ./karma/tests-chrome.cjs","test:chrome:eh":"karma start ./karma/tests-chrome-eh.cjs","test:chrome:coverage":"karma start ./karma/tests-chrome-coverage.cjs","test:browser":"karma start ./karma/tests-all.cjs","test:browser:debug":"karma start ./karma/tests-debug.cjs",test:"npm run test:chrome && npm run test:node","test:coverage":"npm run test:chrome:coverage && npm run test:node:coverage && npm run report",lint:"eslint src test"},ou=["dist","!dist/types/test"],au="dist/duckdb-browser.cjs",cu="dist/duckdb-browser.mjs",lu="dist/duckdb-browser.d.ts",uu="dist/duckdb-browser.cjs",du="dist/duckdb-browser.mjs",hu=!1,fu={fs:!1,path:!1,perf_hooks:!1,os:!1,worker_threads:!1},pu={"./dist/duckdb-mvp.wasm":"./dist/duckdb-mvp.wasm","./dist/duckdb-eh.wasm":"./dist/duckdb-eh.wasm","./dist/duckdb-coi.wasm":"./dist/duckdb-coi.wasm","./dist/duckdb-browser":"./dist/duckdb-browser.mjs","./dist/duckdb-browser.cjs":"./dist/duckdb-browser.cjs","./dist/duckdb-browser.mjs":"./dist/duckdb-browser.mjs","./dist/duckdb-browser-blocking":"./dist/duckdb-browser-blocking.mjs","./dist/duckdb-browser-blocking.mjs":"./dist/duckdb-browser-blocking.mjs","./dist/duckdb-browser-blocking.cjs":"./dist/duckdb-browser-blocking.cjs","./dist/duckdb-browser-coi.pthread.worker.js":"./dist/duckdb-browser-coi.pthread.worker.js","./dist/duckdb-browser-coi.worker.js":"./dist/duckdb-browser-coi.worker.js","./dist/duckdb-browser-eh.worker.js":"./dist/duckdb-browser-eh.worker.js","./dist/duckdb-browser-mvp.worker.js":"./dist/duckdb-browser-mvp.worker.js","./dist/duckdb-node":"./dist/duckdb-node.cjs","./dist/duckdb-node.cjs":"./dist/duckdb-node.cjs","./dist/duckdb-node-blocking":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-blocking.cjs":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-eh.worker.cjs":"./dist/duckdb-node-eh.worker.cjs","./dist/duckdb-node-mvp.worker.cjs":"./dist/duckdb-node-mvp.worker.cjs","./blocking":{browser:{types:"./dist/duckdb-browser-blocking.d.ts",import:"./dist/duckdb-browser-blocking.mjs",require:"./dist/duckdb-browser-blocking.cjs"},node:{types:"./dist/duckdb-node-blocking.d.ts",require:"./dist/duckdb-node-blocking.cjs",import:"./dist/duckdb-node-blocking.cjs"},types:"./dist/duckdb-browser-blocking.d.ts",import:"./dist/duckdb-browser-blocking.mjs",require:"./dist/duckdb-browser-blocking.cjs"},".":{browser:{types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"},node:{types:"./dist/duckdb-node.d.ts",import:"./dist/duckdb-node.cjs",require:"./dist/duckdb-node.cjs"},types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"}},yu={name:ql,version:Zl,description:Xl,license:tu,repository:eu,keywords:iu,dependencies:nu,devDependencies:su,scripts:ru,files:ou,main:au,module:cu,types:lu,jsdelivr:uu,unpkg:du,sideEffects:hu,browser:fu,exports:pu},Yn=yu.version.split(".");Yn[0];Yn[1];Yn[2];Cl(Pl());var Ju="/sveltekit-typescript/internal/assets/duckdb-mvp-4d423df8.wasm",Ku=Worker;function Qu(){return new Worker("/sveltekit-typescript/internal/assets/duckdb-browser-mvp.worker.5bb96a25.js",{type:"module"})}export{xu as A,Mo as B,fo as C,zu as D,Lu as E,mu as F,bu as G,gu as H,_u as I,Io as J,Ue as K,Ku as L,Hu as M,Ju as N,Mu as O,Uu as P,vu as Q,Au as R,Vu as S,Qu as W,Gu as X,Fo as a,Fu as b,Ou as c,So as d,Ao as e,Eu as f,wu as g,Bo as h,ju as i,Bu as j,Iu as k,Su as l,Tu as m,No as n,Ro as o,Do as p,ws as q,Ru as r,mo as s,hn as t,Du as u,Nu as v,Cu as w,Pu as x,Lo as y,ku as z};
